(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["wx-jump-stage1"],{"22b5":function(t,e,n){"use strict";(function(t){var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;t=void 0!==t?t:i.now();while(n.length>0){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var a=this._tweens[n[r]];a&&!1===a.update(t)&&(a._isPlaying=!1,e||delete this._tweens[n[r]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i=new n;i.Group=n,i._nextId=0,i.nextId=function(){return i._nextId++},"undefined"===typeof self&&"undefined"!==typeof t&&t.hrtime?i.now=function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?i.now=self.performance.now.bind(self.performance):void 0!==Date.now?i.now=Date.now:i.now=function(){return(new Date).getTime()},i.Tween=function(t,e){this._isPaused=!1,this._pauseStart=null,this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=i.Easing.Linear.None,this._interpolationFunction=i.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||i,this._id=i.nextId()},i.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},duration:function(t){return this._duration=t,this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"===typeof t?i.now()+parseFloat(t):t:i.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&("undefined"===typeof this._valuesStart[e]&&(this._valuesStart[e]=this._object[e]),this._valuesStart[e]instanceof Array===!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(t){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=void 0===t?i.now():t,this._group.remove(this),this)},resume:function(t){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=(void 0===t?i.now():t)-this._pauseStart,this._pauseStart=0,this._group.add(this),this):this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,n,i;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration,n=0===this._duration||n>1?1:n,i=this._easingFunction(n),this._valuesEnd)if(void 0!==this._valuesStart[e]){var r=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this._object[e]=this._interpolationFunction(a,i):("string"===typeof a&&(a="+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),"number"===typeof a&&(this._object[e]=r+(a-r)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var o=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=o}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,u=this._chainedTweens.length;s<u;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}return!0}},i.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*i.Easing.Bounce.In(2*t):.5*i.Easing.Bounce.Out(2*t-1)+.5}}},i.Interpolation={Linear:function(t,e){var n=t.length-1,r=n*e,a=Math.floor(r),o=i.Interpolation.Utils.Linear;return e<0?o(t[0],t[1],r):e>1?o(t[n],t[n-1],n-r):o(t[a],t[a+1>n?n:a+1],r-a)},Bezier:function(t,e){for(var n=0,r=t.length-1,a=Math.pow,o=i.Interpolation.Utils.Bernstein,s=0;s<=r;s++)n+=a(1-e,r-s)*a(e,s)*t[s]*o(r,s);return n},CatmullRom:function(t,e){var n=t.length-1,r=n*e,a=Math.floor(r),o=i.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(a=Math.floor(r=n*(1+e))),o(t[(a-1+n)%n],t[a],t[(a+1)%n],t[(a+2)%n],r-a)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],r-n)-t[n]):o(t[a?a-1:0],t[a],t[n<a+1?n:a+1],t[n<a+2?n:a+2],r-a)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=i.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,r){var a=.5*(n-t),o=.5*(i-e),s=r*r,u=r*s;return(2*e-2*n+a+o)*u+(-3*e+3*n-2*a-o)*s+a*r+e}}},e["a"]=i}).call(this,n("f28c"))},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"5d73":function(t,e,n){t.exports=n("469f")},"768b":function(t,e,n){"use strict";var i=n("a745"),r=n.n(i);function a(t){if(r()(t))return t}var o=n("5d73"),s=n.n(o),u=n("c8bb"),h=n.n(u);function c(t,e){if(h()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,r=!1,a=void 0;try{for(var o,u=s()(t);!(i=(o=u.next()).done);i=!0)if(n.push(o.value),e&&n.length===e)break}catch(c){r=!0,a=c}finally{try{i||null==u["return"]||u["return"]()}finally{if(r)throw a}}return n}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(t,e){return a(t)||c(t,e)||l()}n.d(e,"a",(function(){return p}))},"7d7b":function(t,e,n){var i=n("e4ae"),r=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},"8bb1":function(t,e,n){},a56b:function(t,e,n){"use strict";var i=n("8bb1"),r=n.n(i);r.a},b0b4:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("85f2"),r=n.n(i);function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r()(t,i.key,i)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}},d225:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return i}))},e424:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"jump-world"},[n("canvas",{attrs:{id:"jump-world-canvas"}})])}],a=(n("ac6a"),n("768b")),o=n("d225"),s=n("b0b4"),u=n("5a89"),h=n("22b5"),c=Math.random,l=Math.sqrt,p=Math.floor,f=Math.pow,d=Math.sin,v=Math.cos,g=Math.tan,y=Math.PI;function m(t,e,n,i,r,a){var o=t*(y/180),s=e*(y/180),u=v(o)*i,h=d(o)*(a-r-n/g(o));if(!(u>h)){var c=u+(h-u)/2,l=c/g(o),p=d(s)*l,f=v(s)*l;return{x:p,y:c,z:f}}console.warn("警告: 垂直角度太小了!")}var w=new u["MeshLambertMaterial"],b=new u["BoxBufferGeometry"],_=[6799930,15114812,16084076,9474969,4235007,16777215],S=function(t){return t[p(c()*t.length)]},P=function(t,e){return p(c()*(e-t+1))+t},x=function t(e){var n=t.box3||(t.box3=new u["Box3"]);return n.setFromObject(e),n.getSize(new u["Vector3"])},O=function(t,e,n){var i=d(2*e),r=d(e),a=f(t,2)*i/n,o=f(t*r,2)/(2*n);return{rangeR:a,rangeH:o}},k=function(t,e,n){var i=e.x,r=e.z,a=n.x,o=n.z,s=a-i,u=o-r,h=l(f(u,2)+f(s,2)),c=s*t/h,p=u*t/h;return{jumpDownX:i+c,jumpDownZ:r+p}},C=function(t,e,n){var i=t.from,r=t.to,a=t.duration,o=t.easing,s=void 0===o?function(t){return t}:o,u=t.autoStart,c=void 0===u||u,l=new h["a"].Tween(i).to(r,a).easing(s).onUpdate(e).onComplete((function(){n&&n()}));return c&&l.start(),j(),l},j=function t(){if(!t.openin){t.openin=!0;var e=function e(){var n=requestAnimationFrame(e);h["a"].update()||(t.openin=!1,cancelAnimationFrame(n))};e()}},T=(n("8e6e"),n("456d"),n("bd86"));function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(n,!0).forEach((function(e){Object(T["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var I=function(){function t(e){var n=e.width,i=e.height,r=e.canvas,a=e.axesHelper,s=void 0!==a&&a,u=e.cameraNear,h=e.cameraFar,c=e.cameraInitalPosition,l=e.lightInitalPosition;Object(o["a"])(this,t),this.width=n,this.height=i,this.canvas=r,this.axesHelper=s,this.cameraNear=u,this.cameraFar=h,this.cameraInitalPosition=c,this.lightInitalPosition=l,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.createScene(),this.createPlane(),this.createLight(),this.createCamera(),this.createRenterer(),this.render()}},{key:"createScene",value:function(){var t=this.scene=new u["Scene"];t.background=new u["Color"](14080991),this.axesHelper&&t.add(new u["AxesHelper"](1e4))}},{key:"createPlane",value:function(){var t=this.scene,e=new u["PlaneBufferGeometry"](1e3,1e3,1,1),n=new u["ShadowMaterial"];n.opacity=.5;var i=this.plane=new u["Mesh"](e,n);i.rotation.x=-.5*Math.PI,i.position.y=-.1,i.receiveShadow=!0,t.add(i)}},{key:"createLight",value:function(){var t=this.scene,e=this.lightInitalPosition,n=e.x,i=e.y,r=e.z,a=this.height,o=this.light=new u["DirectionalLight"](16777215,.5),s=this.lightTarget=new u["Object3D"];o.target=s,o.position.set(n,i,r),o.castShadow=!0,o.shadow.camera.left=-a,o.shadow.camera.right=a,o.shadow.camera.top=a,o.shadow.camera.bottom=-a,o.shadow.camera.near=0,o.shadow.camera.far=2e3,o.shadow.mapSize.width=1600,o.shadow.mapSize.height=1600,t.add(new u["AmbientLight"](15067113,.4)),t.add(new u["HemisphereLight"](16777215,16777215,.2)),t.add(s),t.add(o)}},{key:"createCamera",value:function(){var t=this.scene,e=this.width,n=this.height,i=this.cameraInitalPosition,r=i.x,a=i.y,o=i.z,s=this.cameraNear,h=this.cameraFar,c=this.camera=new u["OrthographicCamera"](-e/2,e/2,n/2,-n/2,s,h);c.position.set(r,a,o),c.lookAt(t.position),t.add(c)}},{key:"createRenterer",value:function(){var t=this.canvas,e=this.width,n=this.height,i=this.renderer=new u["WebGLRenderer"]({canvas:t,alpha:!0,antialias:!0});i.setSize(e,n),i.shadowMap.enabled=!0,i.setPixelRatio(window.devicePixelRatio)}},{key:"render",value:function(){var t=this.scene,e=this.camera;this.renderer.render(t,e)}},{key:"moveCamera",value:function(t,e,n){var i=this,r=t.cameraTo,a=t.center,o=t.lightTo,s=this.camera,u=this.plane,h=this.light,c=this.lightTarget,l=this.lightInitalPosition;C({from:z({},s.position),to:r,duration:n},(function(t){var e=t.x,n=(t.y,t.z);s.position.x=e,s.position.z=n,i.render()}),e);var p=l.x,f=l.z;C({from:z({},h.position),to:o,duration:n},(function(t){var e=t.x,n=t.y,i=t.z;c.position.x=e-p,c.position.z=i-f,h.position.set(e,n,i)})),u.position.x=a.x,u.position.z=a.z}},{key:"add",value:function(){var t;return(t=this.scene).add.apply(t,arguments)}},{key:"remove",value:function(){var t;return(t=this.scene).remove.apply(t,arguments)}}]),t}(),E=I,R=[],D=[function(t,e){var n=Object(a["a"])(e.propSizeRange,2),i=n[0],r=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,u=e.baseBoxBufferGeometry;(void 0)();var h=S(_),c=P(i,r),l=u.clone();l.scale(c,o,c);var p=s.clone();return p.setValues({color:h}),new t.Mesh(l,p)},function(t,e){var n=Object(a["a"])(e.propSizeRange,2),i=n[0],r=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,u=e.baseCylinderBufferGeometry;(void 0)();var h=S(_),c=P(i,r),l=u.clone();l.scale(Math.ceil(c/2),o,Math.ceil(c/2));var p=s.clone();return p.setValues({color:h}),new t.Mesh(l,p)}],Y=function(){function t(e){var n=e.propHeight,i=e.propSizeRange,r=e.needDefaultCreator;Object(o["a"])(this,t),this.propHeight=n,this.propSizeRange=i,this.propCreators=[],r&&(this.createPropCreator(D,!1),this.createPropCreator(R,!0))}return Object(s["a"])(t,[{key:"createProp",value:function(t){var e=this.propCreators;return t>-1&&e[t]&&e[t]()||S(e)()}},{key:"createPropCreator",value:function(t,e){var n=this;if(Array.isArray(t))t.forEach((function(t){return n.createPropCreator(t,e)}));else{var i=this.propCreators,r=this.propSizeRange,a=this.propHeight;if(!(i.indexOf(t)>-1)){var o=function n(){if(e&&n.box)return n.box.clone();var i=t(u,{propSizeRange:r,propHeight:a,baseMeshLambertMaterial:w,baseBoxBufferGeometry:b});return e&&(n.box=i),i};i.push(o),console.log()}}}}]),t}(),L=Y,H=n("75fc"),B=function(){function t(e){var n=e.world,i=e.stage,r=e.body,a=e.height,s=e.enterHeight,u=e.distanceRange,h=e.prev;Object(o["a"])(this,t),this.world=n,this.stage=i,this.body=r,this.height=a,this.enterHeight=s,this.distanceRange=u,this.prev=h}return Object(s["a"])(t,[{key:"computeMyPosition",value:function(){var t=this.world,e=this.prev,n=this.distanceRange,i=this.enterHeight,r={x:0,y:i,z:0};if(!e)return r;if(0===i)return r.z=t.width/2,r;var a=e.getPosition(),o=a.x,s=a.z,u=0===Math.round(Math.random()),h=e.getSize(),c=h.x,l=h.z,p=this.getSize(),f=p.x,d=p.z,v=P.apply(void 0,Object(H["a"])(n));return u?(r.x=o+c/2+v+f/2,r.z=s):(r.x=o,r.z=s+l/2+v+d/2),r}},{key:"enterStage",value:function(){var t=this.stage,e=this.body,n=this.height,i=this.computeMyPosition(),r=i.x,a=i.y,o=i.z;e.castShadow=!0,e.receiveShadow=!0,e.position.set(r,a,o),e.geometry.translate(0,n/2,0),t.add(e),t.render(),this.entranceTransition()}},{key:"entranceTransition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,e=this.body,n=this.enterHeight,i=this.stage;0!==n&&C({to:{y:0},from:{y:n},duration:t,easing:h["a"].Easing.Bounce.Out},(function(t){var n=t.y;e.position.setY(n),i.render()}))}},{key:"springbackTransition",value:function(t){var e=this.body,n=this.stage,i=e.scale.y;C({from:{y:i},to:{y:1},duration:t,easing:h["a"].Easing.Bounce.Out},(function(t){var i=t.y;e.scale.setY(i),n.render()}))}},{key:"setNext",value:function(t){this.next=t}},{key:"getNext",value:function(t){return this.next}},{key:"getPosition",value:function(){return this.body.position}},{key:"setPosition",value:function(t,e,n){return this.body.position.set(t,e,n)}},{key:"scaleY",value:function(t){return this.body.scale.setY(t)}},{key:"getSize",value:function(){return x(this.body)}},{key:"dispose",value:function(){var t=this.body,e=this.stage,n=this.prev,i=this.next;this.prev=null,this.next=null,n&&(n.next=null),i&&(i.prev=null),t.geometry.dispose(),t.material.dispose(),e.remove(t)}}]),t}(),F=B;function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(n,!0).forEach((function(e){Object(T["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U=function(){function t(e){var n=e.world,i=e.color,r=e.G;Object(o["a"])(this,t),this.world=n,this.color=i,this.G=r,this.v0=n.width/10,this.theta=90,this.headSegment=null,this.bodyScaleSegment=null,this.bodyRotateSegment=null,this.body=null,this.currentProp=null,this.nextProp=null,this.powerStorageDuration=1500,this.stage=null,this.createBody(),this.resetPowerStorageParameter()}return Object(s["a"])(t,[{key:"bindEvent",value:function(){var t=this,e=this.world.container,n="ontouchstart"in document,i=n?"touchstart":"mousedown",r=n?"touchend":"mouseup",a=function n(){t.jumping||(t.jumping=!0,t.poweringUp=!1,t.jump(),e.removeEventListener(r,n))},o=function(n){n.preventDefault(),t.poweringUp||t.jumping||!t.currentProp||(t.poweringUp=!0,t.powerStorage(),e.addEventListener(r,a,!1))};e.addEventListener(i,o,!1)}},{key:"createBody",value:function(){var t=this.color,e=this.world.width,n=w.clone();n.setValues({color:t});var i=this.headSize=.03*e,r=this.headTranslateY=4.5*i,a=new u["SphereGeometry"](i,40,40),o=this.headSegment=new u["Mesh"](a,n);o.castShadow=!0,o.translateY(r),this.bodySize=4.5*i;var s=new u["CylinderBufferGeometry"](.9*i,1.2*i,2.5*i,40);s.translate(0,1.25*i,0);var h=new u["CylinderBufferGeometry"](i,.9*i,i,40);h.translate(0,3*i,0);var c=new u["SphereGeometry"](i,40,40);c.translate(0,3.5*i,0);var l=new u["Geometry"];l.merge(c),l.merge((new u["Geometry"]).fromBufferGeometry(h)),l.merge((new u["Geometry"]).fromBufferGeometry(s));var p=this.bodyScaleSegment=new u["Mesh"](l,n);p.castShadow=!0,p.translateY(-20);var f=this.bodyRotateSegment=new u["Group"];f.add(o),f.add(p),f.translateY(20);var d=this.body=new u["Group"];d.add(f)}},{key:"enterStage",value:function(t,e,n){var i=e.x,r=e.y,a=e.z,o=this.body;o.position.set(i,r,a),this.stage=t,this.nextProp=n,t.add(o),t.render(),this.bindEvent()}},{key:"resetPowerStorageParameter",value:function(){this.toValues={headTranslateY:0,bodyScaleXZ:0,bodyScaleY:0},this.fromValues=this.fromValues||{headTranslateY:this.headTranslateY,bodyScaleXZ:1,bodyScaleY:1,propScaleY:1}}},{key:"powerStorage",value:function(){var t=this,e=this.stage,n=this.powerStorageDuration,i=this.body,r=this.bodyScaleSegment,a=this.headSegment,o=this.bodySize,s=this.fromValues,u=this.currentProp,h=this.world.propHeight;this.powerStorageTime=Date.now(),this.resetPowerStorageParameter();var c=C({from:A({},s),to:{headTranslateY:o-.6*o,bodyScaleXZ:1.3,bodyScaleY:.6,propScaleY:.6},duration:n},(function(n){var o=n.headTranslateY,s=n.bodyScaleXZ,l=n.bodyScaleY,p=n.propScaleY;t.poweringUp?(a.position.setY(o),r.scale.set(s,l,s),u.scaleY(p),i.position.setY(h*p),t.toValues={headTranslateY:o,bodyScaleXZ:s,bodyScaleY:l},e.render()):c.stop()}))}},{key:"computePowerStorageValue",value:function(){var t=this.powerStorageDuration,e=this.powerStorageTime,n=this.v0,i=this.theta,r=Date.now()-e,a=Math.min(r,t),o=a/t;return{v0:n+30*o,theta:i-40*o}}},{key:"jump",value:function(){var t=this,e=this.stage,n=this.body,i=this.currentProp,r=this.nextProp,a=this.world.propHeight,o=400,s=n.position,u=r.getPosition(),c=s.x,l=s.y,p=s.z;if(i||c!==u.x||p!==u.z){if(!i)return;var f=this.bodyScaleSegment,d=this.headSegment,v=this.G,g=(this.headTranslateY,this.computePowerStorageValue()),y=g.v0,m=g.theta,w=O(y,m*(Math.PI/180),v),b=w.rangeR,_=w.rangeH,S=k(b,s,u),P=S.jumpDownX,x=S.jumpDownZ;C({from:A({x:c,z:p},this.toValues),to:A({x:P,z:x},this.fromValues),duration:o},(function(t){var e=t.x,i=t.z,r=t.headTranslateY,a=t.bodyScaleXZ,o=t.bodyScaleY;n.position.setX(e),n.position.setZ(i),d.position.setY(r),f.scale.set(a,o,a)}));var j=Math.max(this.world.width/3,_)+a,T=C({from:{y:l},to:{y:j},duration:.65*o,easing:h["a"].Easing.Cubic.Out,autoStart:!1},(function(t){var e=t.y;n.position.setY(e)})),M=C({from:{y:j},to:{y:a},duration:.35*o,easing:h["a"].Easing.Cubic.In,autoStart:!1},(function(t){var e=t.y;n.position.setY(e)})),z=function(){var e=t.world;e.createProp(),e.moveCamera(),t.currentProp=r,t.nextProp=r.getNext(),t.jumping=!1},I=C({from:{s:.8},to:{s:1},duration:100,autoStart:!1},(function(t){var e=t.s;f.scale.setY(e)}),(function(){z()}));M.chain(I),T.chain(M).start();var E=i.getPosition().z===r.getPosition().z;this.flip(o,E),i.springbackTransition(500)}else C({from:{y:l},to:{y:a},duration:o,easing:h["a"].Easing.Bounce.Out},(function(t){var i=t.y;n.position.setY(i),e.render()}),(function(){t.currentProp=r,t.nextProp=r.getNext(),t.jumping=!1}));e.render()}},{key:"flip",value:function(t,e){var n=this.bodyRotateSegment,i=0;C({from:{deg:0},to:{deg:360},duration:t,easing:h["a"].Easing.Sinusoidal.InOut},(function(t){var r=t.deg;e?n.rotateZ(-(r-i)*(Math.PI/180)):n.rotateX((r-i)*(Math.PI/180)),i=r}))}}]),t}(),V=U,N=function(){function t(e){var n=e.container,i=e.canvas,r=e.needDefaultCreator,a=void 0===r||r,s=e.axesHelper,u=void 0!==s&&s;Object(o["a"])(this,t);var h=n.offsetWidth,c=n.offsetHeight;this.G=9.8,this.container=n,this.canvas=i,this.width=h,this.height=c,this.needDefaultCreator=a,this.axesHelper=u;var l=~~(h/6),p=~~(h/3.5);this.propSizeRange=[l,p],this.propHeight=~~(p/2),this.propDistanceRange=[~~(l/2),2*p],this.stage=null,this.propCreator=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.initStage(),this.initPropCreator(),this.computeSafeClearLength(),this.createProp(0),this.createProp(0),this.moveCamera(0),this.initLittleMan()}},{key:"initStage",value:function(){this.container;var t=this.canvas,e=this.axesHelper,n=this.width,i=this.height,r=.1,a=2e3,o=this.cameraInitalPosition=m(35,225,i/2,i/2,r,a),s=this.lightInitalPosition={x:-300,y:600,z:200};this.stage=new E({width:n,height:i,canvas:t,axesHelper:e,cameraNear:r,cameraFar:a,cameraInitalPosition:o,lightInitalPosition:s})}},{key:"initPropCreator",value:function(){var t=this.needDefaultCreator,e=this.propSizeRange,n=this.propHeight;this.props=[],this.propCreator=new L({propHeight:n,propSizeRange:e,needDefaultCreator:t})}},{key:"createPropCreator",value:function(){var t;(t=this.propCreator).createPropCreator.apply(t,arguments)}},{key:"initLittleMan",value:function(){var t=this.stage,e=this.propHeight,n=this.G,i=this.props,r=this.littleMan=new V({world:this,color:3696793,G:n});r.enterStage(t,{x:0,y:e+80,z:0},i[0]),r.jump()}},{key:"createProp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=(this.height,this.propCreator),n=this.propHeight,i=Object(a["a"])(this.propSizeRange,2),r=i[0],o=i[1],s=this.propDistanceRange,u=this.stage,h=this.props,c=this.props.length,l=h[c-1],p=new F({world:this,stage:u,body:e.createProp(c<3?0:-1),height:n,prev:l,enterHeight:t,distanceRange:s}),f=p.getSize();f.y!==n&&console.warn("高度: ".concat(f.y,",盒子高度必须为 ").concat(n)),(f.x<r||f.x>o)&&console.warn("宽度: ".concat(f.x,", 盒子宽度必须为 ").concat(r," - ").concat(o)),(f.z<r||f.z>o)&&console.warn("深度: ".concat(f.z,", 盒子深度度必须为 ").concat(r," - ").concat(o)),l&&l.setNext(p),p.enterStage(),h.push(p)}},{key:"moveCamera",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=this.stage,i=this.height,r=this.cameraInitalPosition,a=r.x,o=r.y,s=r.z,u=this.lightInitalPosition,h=u.x,c=u.y,l=u.z,p=i/10,f=this.getLastTwoCenterPosition(),d=f.x,v=f.y,g=f.z,y={x:d+a+p,y:o,z:g+s+p},m={x:d+h,y:c,z:g+l},w={cameraTo:y,lightTo:m,center:{x:d,y:v,z:g}};n.moveCamera(w,(function(){t.clearProps()}),e)}},{key:"getLastTwoCenterPosition",value:function(){var t=this.props,e=this.props.length,n=t[e-2].getPosition(),i=n.x,r=n.z,a=t[e-1].getPosition(),o=a.x,s=a.z;return{x:i+(o-i)/2,z:r+(s-r)/2}}},{key:"clearProps",value:function(){this.width,this.height;var t=this.safeClearLength,e=this.props,n=(this.stage,this.props.length),i=4;n>t&&(e.slice(0,i).forEach((function(t){return t.dispose()})),this.props=e.slice(i))}},{key:"computeSafeClearLength",value:function(){var t=this.width,e=this.height,n=this.propSizeRange,i=n[0],r=Math.sqrt(i*i+i*i);this.safeClearLength=Math.ceil(t/i)+Math.ceil(e/r/2)+1}}]),t}(),X=N,Z={mounted:function(){new X({container:document.querySelector(".jump-world"),canvas:document.querySelector("#jump-world-canvas"),axesHelper:!0})}},q=Z,Q=(n("a56b"),n("2877")),J=Object(Q["a"])(q,i,r,!1,null,"0bf23ea4",null);e["default"]=J.exports},f28c:function(t,e){var n,i,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}function u(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(function(){try{n="function"===typeof setTimeout?setTimeout:a}catch(t){n=a}try{i="function"===typeof clearTimeout?clearTimeout:o}catch(t){i=o}})();var h,c=[],l=!1,p=-1;function f(){l&&h&&(l=!1,h.length?c=h.concat(c):p=-1,c.length&&d())}function d(){if(!l){var t=s(f);l=!0;var e=c.length;while(e){h=c,c=[];while(++p<e)h&&h[p].run();p=-1,e=c.length}h=null,l=!1,u(t)}}function v(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new v(t,e)),1!==c.length||l||s(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}}]);