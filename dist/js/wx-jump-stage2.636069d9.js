(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["wx-jump-stage2"],{"02f4":function(t,e,n){var i=n("4588"),a=n("be13");t.exports=function(t){return function(e,n){var r,o,s=String(a(e)),c=i(n),u=s.length;return c<0||c>=u?t?"":void 0:(r=s.charCodeAt(c),r<55296||r>56319||c+1===u||(o=s.charCodeAt(c+1))<56320||o>57343?t?s.charAt(c):r:t?s.slice(c,c+2):o-56320+(r-55296<<10)+65536)}}},"1ba6":function(t,e,n){},"1c4c":function(t,e,n){"use strict";var i=n("9b43"),a=n("5ca1"),r=n("4bf8"),o=n("1fa8"),s=n("33a4"),c=n("9def"),u=n("f1ae"),h=n("27ee");a(a.S+a.F*!n("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,a,l,p=r(t),d="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,v=void 0!==g,m=0,y=h(p);if(v&&(g=i(g,f>2?arguments[2]:void 0,2)),void 0==y||d==Array&&s(y))for(e=c(p.length),n=new d(e);e>m;m++)u(n,m,v?g(p[m],m):p[m]);else for(l=y.call(p),n=new d;!(a=l.next()).done;m++)u(n,m,v?o(l,g,[a.value,m],!0):a.value);return n.length=m,n}})},"22b5":function(t,e,n){"use strict";(function(t){var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;t=void 0!==t?t:i.now();while(n.length>0){this._tweensAddedDuringUpdate={};for(var a=0;a<n.length;a++){var r=this._tweens[n[a]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[n[a]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i=new n;i.Group=n,i._nextId=0,i.nextId=function(){return i._nextId++},"undefined"===typeof self&&"undefined"!==typeof t&&t.hrtime?i.now=function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?i.now=self.performance.now.bind(self.performance):void 0!==Date.now?i.now=Date.now:i.now=function(){return(new Date).getTime()},i.Tween=function(t,e){this._isPaused=!1,this._pauseStart=null,this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=i.Easing.Linear.None,this._interpolationFunction=i.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||i,this._id=i.nextId()},i.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},duration:function(t){return this._duration=t,this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"===typeof t?i.now()+parseFloat(t):t:i.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&("undefined"===typeof this._valuesStart[e]&&(this._valuesStart[e]=this._object[e]),this._valuesStart[e]instanceof Array===!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(t){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=void 0===t?i.now():t,this._group.remove(this),this)},resume:function(t){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=(void 0===t?i.now():t)-this._pauseStart,this._pauseStart=0,this._group.add(this),this):this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onRepeat:function(t){return this._onRepeatCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,n,i;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration,n=0===this._duration||n>1?1:n,i=this._easingFunction(n),this._valuesEnd)if(void 0!==this._valuesStart[e]){var a=this._valuesStart[e]||0,r=this._valuesEnd[e];r instanceof Array?this._object[e]=this._interpolationFunction(r,i):("string"===typeof r&&(r="+"===r.charAt(0)||"-"===r.charAt(0)?a+parseFloat(r):parseFloat(r)),"number"===typeof r&&(this._object[e]=a+(r-a)*i))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"===typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var o=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=o}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,c=this._chainedTweens.length;s<c;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}return!0}},i.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-i.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*i.Easing.Bounce.In(2*t):.5*i.Easing.Bounce.Out(2*t-1)+.5}}},i.Interpolation={Linear:function(t,e){var n=t.length-1,a=n*e,r=Math.floor(a),o=i.Interpolation.Utils.Linear;return e<0?o(t[0],t[1],a):e>1?o(t[n],t[n-1],n-a):o(t[r],t[r+1>n?n:r+1],a-r)},Bezier:function(t,e){for(var n=0,a=t.length-1,r=Math.pow,o=i.Interpolation.Utils.Bernstein,s=0;s<=a;s++)n+=r(1-e,a-s)*r(e,s)*t[s]*o(a,s);return n},CatmullRom:function(t,e){var n=t.length-1,a=n*e,r=Math.floor(a),o=i.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(a=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],a-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-a)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],a-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],a-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=i.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,a){var r=.5*(n-t),o=.5*(i-e),s=a*a,c=a*s;return(2*e-2*n+r+o)*c+(-3*e+3*n-2*r-o)*s+r*a+e}}},e["a"]=i}).call(this,n("f28c"))},"386b":function(t,e,n){var i=n("5ca1"),a=n("79e5"),r=n("be13"),o=/"/g,s=function(t,e,n,i){var a=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+a+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),i(i.P+i.F*a((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},"469f":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("7d7b")},"4a95":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"jump-world"},[n("canvas",{attrs:{id:"jump-world-canvas"}}),n("div",{staticClass:"score"},[t._v("\n      "+t._s(t.score)+"\n    ")]),t.isMask?n("div",{staticClass:"mask"},[t.isRunning?n("div",{staticClass:"mask-button",on:{click:function(e){return t.restart()}}},[n("i",{staticClass:"el-icon-refresh-left",staticStyle:{color:"#3CB371"}}),t._v("\n       再玩一局\n    ")]):t._e(),t.isRunning?t._e():n("div",{staticClass:"mask-button",on:{click:function(e){return t.start()}}},[n("i",{staticClass:"el-icon-caret-right",staticStyle:{color:"#3CB371"}}),t._v("\n        开始游戏\n    ")])]):t._e()])},a=[],r=(n("ac6a"),n("768b")),o=n("d225"),s=n("b0b4"),c=(n("8e6e"),n("456d"),n("bd86")),u=n("5a89"),h=(n("673e"),n("5df3"),n("1c4c"),n("22b5")),l=Math.random,p=Math.sqrt,d=Math.floor,f=Math.pow,g=Math.sin,v=Math.cos,m=Math.tan,y=Math.PI,b=0,w=function(){return b++},S=function(){return b=0};function P(t,e,n,i,a,r){var o=t*(y/180),s=e*(y/180),c=v(o)*i,u=g(o)*(r-a-n/m(o));if(!(c>u)){var h=c+(u-c)/2,l=h/m(o),p=g(s)*l,d=v(s)*l;return{x:p,y:h,z:d}}console.warn("警告: 垂直角度太小了!")}var O=new u["MeshLambertMaterial"],A=new u["BoxBufferGeometry"];A.userData.type="box";var x=new u["CylinderBufferGeometry"](1,1,1,30,5);x.userData.type="cylinder";var j=function(t){return t[d(l()*t.length)]},M=function(t,e){return d(l()*(e-t+1))+t},E=function t(e){var n=t.box3||(t.box3=new u["Box3"]);return n.setFromObject(e),n.getSize(new u["Vector3"])},C=function(t,e,n){var i=g(2*e),a=g(e),r=f(t,2)*i/n,o=f(t*a,2)/(2*n);return{rangeR:r,rangeH:o}},z=function(t,e,n){var i=e.x,a=e.z,r=n.x,o=n.z,s=r-i,c=o-a,u=p(f(s,2)+f(c,2)),h=t/u*s,l=t/u*c;return{jumpDownX:h+i,jumpDownZ:l+a}},R=function(t,e,n){var i=t.from,a=t.to,r=t.duration,o=t.easing,s=void 0===o?function(t){return t}:o,c=t.autoStart,u=void 0===c||c,l=new h["a"].Tween(i).to(a,r).easing(s).onUpdate(e).onComplete((function(){n&&n()}));return u&&l.start(),l},k=function(t){t.geometry&&(t.geometry.dispose(),t.geometry=null),t.material&&(t.material.dispose(),t.material=null),t.parent.remove(t),t.parent=null,t=null},Y=function(t,e,n){var i=t.position.clone(),a=t.geometry.attributes.position,r=a.count,o=Array.from({length:r}).map((function(t,e){return(new u["Vector3"]).fromBufferAttribute(a,e)})).filter((function(t){return"z"===e&&n?t.z<0:"z"===e?t.z>0:"x"===e&&n?t.x<0:"x"===e?t.x>0:void 0})).map((function(e){var n=e.applyMatrix4(t.matrix);return n.sub(t.position)}));return function(t){for(var e,n=0;e=o[n];n++){var a=new u["Raycaster"](i,e.clone().normalize()),r=a.intersectObject(t,!0);if(r.length>0&&r[0].distance<e.length()+1.2)return!0}return!1}},D=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new u["Vector3"],this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:u["MOUSE"].ROTATE,MIDDLE:u["MOUSE"].DOLLY,RIGHT:u["MOUSE"].PAN},this.touches={ONE:u["TOUCH"].ROTATE,TWO:u["TOUCH"].DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),s=o.NONE},this.update=function(){var e=new u["Vector3"],a=(new u["Quaternion"]).setFromUnitVectors(t.up,new u["Vector3"](0,1,0)),r=a.clone().inverse(),g=new u["Vector3"],v=new u["Quaternion"];return function(){var t=n.object.position;return e.copy(t).sub(n.target),e.applyQuaternion(a),h.setFromVector3(e),n.autoRotate&&s===o.NONE&&j(A()),n.enableDamping?(h.theta+=l.theta*n.dampingFactor,h.phi+=l.phi*n.dampingFactor):(h.theta+=l.theta,h.phi+=l.phi),h.theta=Math.max(n.minAzimuthAngle,Math.min(n.maxAzimuthAngle,h.theta)),h.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=p,h.radius=Math.max(n.minDistance,Math.min(n.maxDistance,h.radius)),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),e.setFromSpherical(h),e.applyQuaternion(r),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),d.set(0,0,0)),p=1,!!(f||g.distanceToSquared(n.object.position)>c||8*(1-v.dot(n.object.quaternion))>c)&&(n.dispatchEvent(i),g.copy(n.object.position),v.copy(n.object.quaternion),f=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",st,!1),n.domElement.removeEventListener("mousedown",$,!1),n.domElement.removeEventListener("wheel",nt,!1),n.domElement.removeEventListener("touchstart",at,!1),n.domElement.removeEventListener("touchend",ot,!1),n.domElement.removeEventListener("touchmove",rt,!1),document.removeEventListener("mousemove",tt,!1),document.removeEventListener("mouseup",et,!1),window.removeEventListener("keydown",it,!1)};var n=this,i={type:"change"},a={type:"start"},r={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=o.NONE,c=1e-6,h=new u["Spherical"],l=new u["Spherical"],p=1,d=new u["Vector3"],f=!1,g=new u["Vector2"],v=new u["Vector2"],m=new u["Vector2"],y=new u["Vector2"],b=new u["Vector2"],w=new u["Vector2"],S=new u["Vector2"],P=new u["Vector2"],O=new u["Vector2"];function A(){return 2*Math.PI/60/60*n.autoRotateSpeed}function x(){return Math.pow(.95,n.zoomSpeed)}function j(t){l.theta-=t}function M(t){l.phi-=t}var E=function(){var t=new u["Vector3"];return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),d.add(t)}}(),C=function(){var t=new u["Vector3"];return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),d.add(t)}}(),z=function(){var t=new u["Vector3"];return function(e,i){var a=n.domElement===document?n.domElement.body:n.domElement;if(n.object.isPerspectiveCamera){var r=n.object.position;t.copy(r).sub(n.target);var o=t.length();o*=Math.tan(n.object.fov/2*Math.PI/180),E(2*e*o/a.clientHeight,n.object.matrix),C(2*i*o/a.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(E(e*(n.object.right-n.object.left)/n.object.zoom/a.clientWidth,n.object.matrix),C(i*(n.object.top-n.object.bottom)/n.object.zoom/a.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function R(t){n.object.isPerspectiveCamera?p/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function k(t){n.object.isPerspectiveCamera?p*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Y(t){g.set(t.clientX,t.clientY)}function D(t){S.set(t.clientX,t.clientY)}function I(t){y.set(t.clientX,t.clientY)}function T(t){v.set(t.clientX,t.clientY),m.subVectors(v,g).multiplyScalar(n.rotateSpeed);var e=n.domElement===document?n.domElement.body:n.domElement;j(2*Math.PI*m.x/e.clientHeight),M(2*Math.PI*m.y/e.clientHeight),g.copy(v),n.update()}function G(t){P.set(t.clientX,t.clientY),O.subVectors(P,S),O.y>0?R(x()):O.y<0&&k(x()),S.copy(P),n.update()}function L(t){b.set(t.clientX,t.clientY),w.subVectors(b,y).multiplyScalar(n.panSpeed),z(w.x,w.y),y.copy(b),n.update()}function B(){}function Z(t){t.deltaY<0?k(x()):t.deltaY>0&&R(x()),n.update()}function _(t){var e=!1;switch(t.keyCode){case n.keys.UP:z(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:z(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:z(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:z(-n.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),n.update())}function F(t){if(1==t.touches.length)g.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);g.set(e,n)}}function H(t){if(1==t.touches.length)y.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);y.set(e,n)}}function N(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);S.set(0,i)}function Q(t){n.enableZoom&&N(t),n.enablePan&&H(t)}function U(t){n.enableZoom&&N(t),n.enableRotate&&F(t)}function V(t){if(1==t.touches.length)v.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);v.set(e,i)}m.subVectors(v,g).multiplyScalar(n.rotateSpeed);var a=n.domElement===document?n.domElement.body:n.domElement;j(2*Math.PI*m.x/a.clientHeight),M(2*Math.PI*m.y/a.clientHeight),g.copy(v)}function X(t){if(1==t.touches.length)b.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(e,i)}w.subVectors(b,y).multiplyScalar(n.panSpeed),z(w.x,w.y),y.copy(b)}function W(t){var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(e*e+i*i);P.set(0,a),O.set(0,Math.pow(P.y/S.y,n.zoomSpeed)),R(O.y),S.copy(P)}function J(t){n.enableZoom&&W(t),n.enablePan&&X(t)}function q(t){n.enableZoom&&W(t),n.enableRotate&&V(t)}function K(){}function $(t){if(!1!==n.enabled){switch(t.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus(),t.button){case 0:switch(n.mouseButtons.LEFT){case u["MOUSE"].ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;I(t),s=o.PAN}else{if(!1===n.enableRotate)return;Y(t),s=o.ROTATE}break;case u["MOUSE"].PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;Y(t),s=o.ROTATE}else{if(!1===n.enablePan)return;I(t),s=o.PAN}break;default:s=o.NONE}break;case 1:switch(n.mouseButtons.MIDDLE){case u["MOUSE"].DOLLY:if(!1===n.enableZoom)return;D(t),s=o.DOLLY;break;default:s=o.NONE}break;case 2:switch(n.mouseButtons.RIGHT){case u["MOUSE"].ROTATE:if(!1===n.enableRotate)return;Y(t),s=o.ROTATE;break;case u["MOUSE"].PAN:if(!1===n.enablePan)return;I(t),s=o.PAN;break;default:s=o.NONE}break}s!==o.NONE&&(document.addEventListener("mousemove",tt,!1),document.addEventListener("mouseup",et,!1),n.dispatchEvent(a))}}function tt(t){if(!1!==n.enabled)switch(t.preventDefault(),s){case o.ROTATE:if(!1===n.enableRotate)return;T(t);break;case o.DOLLY:if(!1===n.enableZoom)return;G(t);break;case o.PAN:if(!1===n.enablePan)return;L(t);break}}function et(t){!1!==n.enabled&&(B(t),document.removeEventListener("mousemove",tt,!1),document.removeEventListener("mouseup",et,!1),n.dispatchEvent(r),s=o.NONE)}function nt(t){!1===n.enabled||!1===n.enableZoom||s!==o.NONE&&s!==o.ROTATE||(t.preventDefault(),t.stopPropagation(),n.dispatchEvent(a),Z(t),n.dispatchEvent(r))}function it(t){!1!==n.enabled&&!1!==n.enableKeys&&!1!==n.enablePan&&_(t)}function at(t){if(!1!==n.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(n.touches.ONE){case u["TOUCH"].ROTATE:if(!1===n.enableRotate)return;F(t),s=o.TOUCH_ROTATE;break;case u["TOUCH"].PAN:if(!1===n.enablePan)return;H(t),s=o.TOUCH_PAN;break;default:s=o.NONE}break;case 2:switch(n.touches.TWO){case u["TOUCH"].DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;Q(t),s=o.TOUCH_DOLLY_PAN;break;case u["TOUCH"].DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;U(t),s=o.TOUCH_DOLLY_ROTATE;break;default:s=o.NONE}break;default:s=o.NONE}s!==o.NONE&&n.dispatchEvent(a)}}function rt(t){if(!1!==n.enabled)switch(t.preventDefault(),t.stopPropagation(),s){case o.TOUCH_ROTATE:if(!1===n.enableRotate)return;V(t),n.update();break;case o.TOUCH_PAN:if(!1===n.enablePan)return;X(t),n.update();break;case o.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;J(t),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;q(t),n.update();break;default:s=o.NONE}}function ot(t){!1!==n.enabled&&(K(t),n.dispatchEvent(r),s=o.NONE)}function st(t){!1!==n.enabled&&t.preventDefault()}n.domElement.addEventListener("contextmenu",st,!1),n.domElement.addEventListener("mousedown",$,!1),n.domElement.addEventListener("wheel",nt,!1),n.domElement.addEventListener("touchstart",at,!1),n.domElement.addEventListener("touchend",ot,!1),n.domElement.addEventListener("touchmove",rt,!1),window.addEventListener("keydown",it,!1),this.update()};D.prototype=Object.create(u["EventDispatcher"].prototype),D.prototype.constructor=D;var I=function(t,e){D.call(this,t,e),this.mouseButtons.LEFT=u["MOUSE"].PAN,this.mouseButtons.RIGHT=u["MOUSE"].ROTATE,this.touches.ONE=u["TOUCH"].PAN,this.touches.TWO=u["TOUCH"].DOLLY_ROTATE};function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(n,!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}I.prototype=Object.create(u["EventDispatcher"].prototype),I.prototype.constructor=I;var L=function(){function t(e){var n=e.container,i=e.axesHelper,a=void 0!==i&&i,r=e.canvas,s=e.cameraInitalPosition,c=e.lightInitalPosition;Object(o["a"])(this,t),this.container=n,this.axesHelper=a,this.canvas=r,this.width=n.offsetWidth,this.height=n.offsetHeight,this.cameraInitalPosition=s,this.lightInitalPosition=c,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null,this.controls=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.createScene(),this.createLight(),this.createPlane(),this.createCamera(),this.createRender(),this.animate()}},{key:"createScene",value:function(){this.scene=new u["Scene"],this.scene.background=new u["Color"](14080991),this.axesHelper&&this.scene.add(new u["AxesHelper"](1e4))}},{key:"createPlane",value:function(){var t=new u["PlaneBufferGeometry"](1e3,1e3,1,1),e=new u["ShadowMaterial"];e.opacity=.5;var n=this.plane=new u["Mesh"](t,e);n.rotation.x=-.5*Math.PI,n.receiveShadow=!0,this.scene.add(n)}},{key:"createCamera",value:function(){var t=this.container.offsetWidth,e=this.container.offsetHeight,n=2e3,i=.1,a=this.cameraInitalPosition;this.camera=new u["OrthographicCamera"](-t/2,t/2,e/2,-e/2,i,n),this.camera.position.set(a.x,a.y,a.z),this.camera.lookAt(this.scene.position),this.scene.add(this.camera)}},{key:"createLight",value:function(){var t=this.scene,e=this.lightInitalPosition,n=e.x,i=e.y,a=e.z,r=this.height,o=this.light=new u["DirectionalLight"](16777215,.5),s=this.lightTarget=new u["Object3D"];o.target=s,o.position.set(n,i,a),o.castShadow=!0,o.shadow.camera.left=-r,o.shadow.camera.right=r,o.shadow.camera.top=r,o.shadow.camera.bottom=-r,o.shadow.camera.near=0,o.shadow.camera.far=2e3,o.shadow.mapSize.width=1600,o.shadow.mapSize.height=1600,t.add(new u["AmbientLight"](15067113,.4)),t.add(new u["HemisphereLight"](16777215,16777215,.2)),t.add(s),t.add(o)}},{key:"createRender",value:function(){var t=this.canvas,e=this.container;this.renderer=new u["WebGLRenderer"]({canvas:t,antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e.offsetWidth,e.offsetHeight),this.renderer.setClearColor(16777215,.5),this.renderer.shadowMap.enabled=!0}},{key:"createControl",value:function(){this.controls=new D(this.camera,this.renderer.domElement),this.controls.screenSpacePanning=!0,this.controls.minDistance=0,this.controls.maxDistance=400,this.controls.target.set(0,2,0),this.controls.update()}},{key:"animate",value:function(){requestAnimationFrame(this.animate.bind(this)),h["a"].update(),this.render()}},{key:"moveCamera",value:function(t,e,n){var i=t.cameraTo,a=t.center,r=t.lightTo,o=this.camera,s=this.plane,c=this.light,u=this.lightInitalPosition,h=this.lightTarget;this.tween=R({from:G({},o.position),to:i,duration:n},(function(t){var e=t.x,n=(t.y,t.z);o.position.x=e,o.position.z=n}));var l=u.x,p=u.z;R({from:G({},c.position),to:r,duration:n},(function(t){var e=t.x,n=t.y,i=t.z;h.position.x=e-l,h.position.z=i-p,c.position.set(e,n,i)})),s.position.x=a.x,s.position.z=a.z}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"add",value:function(){var t;return(t=this.scene).add.apply(t,arguments)}},{key:"remove",value:function(){var t;return(t=this.scene).remove.apply(t,arguments)}}]),t}(),B=L,Z=[6799930,15114812,16084076,9474969,4235007,16777215],_="我和我的祖国",F=(_.split(),[]),H=[function(t,e){var n=Object(r["a"])(e.propSizeRange,2),i=n[0],a=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,c=e.baseBoxBufferGeometry;w();var u=j(Z),h=b<3?a:M(i,a),l=c.clone();l.scale(h,o,h);var p=s.clone();return p.setValues({color:u}),new t.Mesh(l,p)},function(t,e){var n=Object(r["a"])(e.propSizeRange,2),i=n[0],a=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,c=e.baseCylinderBufferGeometry;w();var u=j(Z),h=b<3?a:M(i,a),l=c.clone();l.scale(Math.ceil(h/2),o,Math.ceil(h/2));var p=s.clone();return p.setValues({color:u}),new t.Mesh(l,p)}],N=function(){function t(e){var n=e.propHeight,i=e.propSizeRange,a=e.needDefaultCreator;Object(o["a"])(this,t),this.propHeight=n,this.propSizeRange=i,this.propCreators=[],a&&(this.createPropCreator(H,!1),this.createPropCreator(F,!0))}return Object(s["a"])(t,[{key:"createProp",value:function(t){return j(this.propCreators)()}},{key:"createPropCreator",value:function(t,e){var n=this;if(Array.isArray(t))t.forEach((function(t){return n.createPropCreator(t,e)}));else{var i=this.propCreators,a=this.propSizeRange,r=this.propHeight;if(!(i.indexOf(t)>-1)){var o=function n(){if(e&&n.box)return n.box.clone();var i=t(u,{propSizeRange:a,propHeight:r,baseMeshLambertMaterial:O,baseBoxBufferGeometry:A,baseCylinderBufferGeometry:x});return e&&(n.box=i),i};this.propCreators.push(o)}}}}]),t}(),Q=N,U=n("75fc"),V=function(){function t(e){var n=e.world,i=e.stage,a=e.body,r=e.height,s=e.prev,c=e.distanceRange,u=e.enterHeight;Object(o["a"])(this,t),this.world=n,this.stage=i,this.body=a,this.height=r,this.prev=s,this.distanceRange=c,this.enterHeight=u}return Object(s["a"])(t,[{key:"enterStage",value:function(){var t=this.stage,e=this.body,n=this.height,i=this.computePosition(),a=i.x,r=i.y,o=i.z;e.castShadow=!0,e.receiveShadow=!0,e.position.set(a,r,o),e.geometry.translate(0,n/2,0),t.add(e),this.enterAnimate()}},{key:"computePosition",value:function(){var t=this.prev,e=this.world,n=this.enterHeight,i={x:0,y:0,z:0};if(void 0===t)return i;if(0===n)return i.z=e.width/2,t.nextDirection="z",i;var a=t.getPosition(),r=a.x,o=a.z,s=0===Math.round(Math.random()),c=t.getSize(),u=c.x,h=c.z,l=this.getSize(),p=l.x,d=l.z,f=M.apply(void 0,Object(U["a"])(this.distanceRange));return s?(i.x=r+u/2+f+p/2,i.z=o,t.nextDirection="x"):(i.x=r,i.z=o+h/2+f+d/2,t.nextDirection="z"),t.nextDistance=f,i}},{key:"enterAnimate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,e=this.enterHeight,n=this.body;0!==e&&R({from:{y:e},to:{y:0},duration:t,easing:h["a"].Easing.Bounce.Out},(function(t){var e=t.y;n.position.setY(e)}))}},{key:"restoreAnimate",value:function(t){var e=this,n=this.body.scale.y;R({from:{y:n},to:{y:1},duration:t},(function(t){var n=t.y;e.body.scale.setY(n)}))}},{key:"computePointInfos",value:function(t,e,n){var i=this.body;if(!i)return{};var a=i.geometry.userData.type,r=this.getSize(),o=r.x,s=r.z,c=this.getPosition(),u=c.x,h=c.z,l=t/2;if("box"===a){var p=o/2,d=s/2,f=u-p,g=u+p,v=h-d,m=h+d,y=e>=f&&e<=g&&n>=v&&n<=m;if(y)return{contains:y};var b=Math.abs(n-h)-d,w=Math.abs(e-u)-p;if(w>=l||b>=l)return{contains:y};var S=!1,P=0,O=0;return e<g&&e>f?(n>m&&n<v+l?P=0:n<v&&n>v-l&&(P=180),S=!0,O=b):n<m&&n>v&&(e>g&&e<g+l?P=90:e<f&&e>f-l&&(P=270),S=!0,O=w),{contains:y,translate:O,isEdge:S,degY:P}}var A=o/2,x=Math.sqrt(Math.pow(e-u,2)+Math.pow(n-h,2)),j=x<=A;if(j)return{contains:j};if(x>A+l)return{contains:j};var M=!0,E=x-A,C=180*Math.atan(Math.abs(e-u)/Math.abs(n-h))/Math.PI;return e===u?C=n>h?0:180:n===h?C=e>u?90:270:e>u&&n>h||(C=e>u&&n<h?180-C:n<h?180+C:360-C),{contains:j,translate:E,isEdge:M,degY:C}}},{key:"setNext",value:function(t){this.next=t}},{key:"getNext",value:function(){return this.next}},{key:"getPosition",value:function(){return this.body.position}},{key:"setPosition",value:function(t,e,n){return this.body.position.set(t,e,n)}},{key:"getSize",value:function(){return E(this.body)}},{key:"dipose",value:function(){var t=this.body;this.prev=null,this.next=null,t.geometry.dipose(),t.material.dipose(),this.stage.remove(t)}}]),t}(),X=V,W=function(){function t(e){var n=e.world,i=e.quantity,a=void 0===i?15:i,r=e.triggerObject;Object(o["a"])(this,t),this.world=n,this.quantity=a,this.triggerObject=r,this.particleSystem=null;var s=E(r),c=s.x,u=s.y;this.triggerObjectWidth=c;var h=this.flowSizeRange=[c/6,c/3];this.flowRangeY=[u/2,u-h[1]],this.initalY=h[1],this.flowRangeX=[2*-c,2*c];var l=this.fountainSizeRange=this.flowSizeRange.map((function(t){return t/2}));this.fountainRangeY=[l[1],u/3],this.fountainRangeDistance=[u/4,u/2],this.fountainRangeX=[-c/3,c/3],this.createParticle()}return Object(s["a"])(t,[{key:"createParticle",value:function(){var t=this,e=this.quantity,i=this.triggerObject,a=new u["Color"](16777215),r=new u["Color"](5822093),o=Array.from({length:e}).map((function(t,e){return e%2?a:r})),s=this.particleSystem=new u["Group"],c=new u["TextureLoader"];c.load(n("bac3"),(function(e){var n=new u["Geometry"];n.vertices.push(new u["Vector3"]);var a=new u["PointsMaterial"]({size:0,map:e,transparent:!0});o.forEach((function(t){var e=n.clone(),i=a.clone();i.setValues({color:t});var r=new u["Points"](e,i);s.add(r)})),t.resetParticle(),i.add(s)}))}},{key:"resetParticle",value:function(){var t=this.particleSystem,e=this.initalY;t.children.forEach((function(t){t.position.y=e,t.position.x=0,t.position.z=0}))}},{key:"runParticleFlowPump",value:function(){var t=this.particleSystem,e=this.quantity,n=this.initalY,i=t.children.filter((function(t){return t.position.y===n}));if(!(i.length<e/3)){var a=this.triggerObjectWidth,r=this.flowRangeX,o=this.flowRangeY,s=this.flowSizeRange,c=a/2;i.forEach((function(t){var e=t.position,n=t.material,i=M.apply(void 0,Object(U["a"])(r)),a=M.apply(void 0,Object(U["a"])(r)),u=i<0?-c:c,h=a<0?-c:c;e.x=i+u,e.z=a+h,e.y=M.apply(void 0,Object(U["a"])(o)),n.setValues({size:M.apply(void 0,Object(U["a"])(s))})}))}}},{key:"runParticleFlow",value:function(){var t=this;if(!this.runningParticleFlow){this.runningParticleFlow=!0;this.world;var e=this.triggerObjectWidth,n=this.particleSystem,i=this.initalY,a=0,r=3*e/1e3,o=function e(){var o=requestAnimationFrame(e);if(t.runningParticleFlow){if(t.runParticleFlowPump(),a){var s=n.children.filter((function(t){return t.position!==i})),c=Date.now()-a,u=c*r;s.forEach((function(t){var e=t.position,n=e.x,a=e.y,r=e.z;if(a<i)e.y=i,e.x=0,e.z=0;else{var o=Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(a-i,2)),s=(o-u)/o;e.x=s*n,e.z=s*r,e.y=s*a}}))}a=Date.now()}else cancelAnimationFrame(o)};o()}}},{key:"stopRunParticleFlow",value:function(){this.runningParticleFlow=!1,this.resetParticle()}},{key:"runParticleFountainPump",value:function(t,e){var n=this,i=this.fountainRangeDistance,a=this.triggerObjectWidth,r=this.initalY;this.world;t.forEach((function(t){var e=t.position,n=e.x,r=e.y,o=e.z,s=t.userData;s.ty=r+M.apply(void 0,Object(U["a"])(i));var c=M(0,a/3);s.tx=(n<0?-c:c)+n;var u=M(0,a/3);s.tz=(o<0?-u:u)+o}));var o=0,s=Date.now(),c=3*a/600,u=function i(){var a=requestAnimationFrame(i),u=t.filter((function(t){return t.position.y!==r}));if(u.length&&!n.runningParticleFlow&&Date.now()-s<e){if(o){var h=Date.now()-o,l=h*c;u.forEach((function(t){var e=t.position,n=t.position,i=n.x,a=n.y,o=n.z,s=t.userData,c=s.tx,u=s.ty,h=s.tz;if(a>=u)e.x=0,e.y=r,e.z=0;else{var p=c-i,d=u-a,f=h-o,g=Math.sqrt(Math.pow(p,2)+Math.pow(d,2)+Math.pow(f,2)),v=l/g;e.y+=v*d,e.x+=v*p,e.z+=v*f}}))}o=Date.now()}else n.runningParticleFountain=!1,cancelAnimationFrame(a)};u()}},{key:"runParticleFountain",value:function(){if(!this.runningParticleFountain){this.runningParticleFountain=!0;var t=this.particleSystem,e=this.quantity,n=this.initalY,i=t.children.filter((function(t){return t.position.y===n})).slice(0,e);if(i.length){var a=this.triggerObjectWidth,r=this.fountainRangeX,o=this.fountainSizeRange,s=this.fountainRangeY,c=a/2;i.forEach((function(t){var e=t.position,n=t.material,i=M.apply(void 0,Object(U["a"])(r)),a=M.apply(void 0,Object(U["a"])(r)),u=i<0?-c:c,h=a<0?-c:c;e.x=u+i,e.z=h+a,e.y=M.apply(void 0,Object(U["a"])(s)),n.setValues({size:M.apply(void 0,Object(U["a"])(o))})})),this.runParticleFountainPump(i,1e3)}}}},{key:"destroy",value:function(){this.particleSystem&&(this.particleSystem.children.forEach(k),this.particleSystem.children=null,k(this.particleSystem)),this.world=null,this.triggerObject=null,this.particleSystem=null}}]),t}(),J=W;function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(n,!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $=function(){function t(e){var n=e.triggerObject;Object(o["a"])(this,t);var i=E(n),a=i.x,r=i.y;this.initalRadius=a,this.initalY=r/6,this.triggerObject=n,this.body=null,this.createWave()}return Object(s["a"])(t,[{key:"createWave",value:function(){var t=new u["TorusBufferGeometry"],e=new u["MeshBasicMaterial"];e.color.set(16777215),e.transparent=!0,this.body=new u["Mesh"](t,e),this.body.rotation.x=-.5*Math.PI,this.triggerObject.add(this.body)}},{key:"resetWave",value:function(){this.body.position.set(0,this.initalY,0)}},{key:"runWaveAnimate",value:function(){var t=this;this.triggerObject.add(this.body),this.resetWave();var e={radius:2*this.initalRadius,tube:this.initalRadius/2,tubularSegments:2,radialSegments:64,opacity:1},n={radius:4*this.initalRadius,tube:this.initalRadius/4,tubularSegments:2,radialSegments:64,opacity:0};R({from:K({},e),to:K({},n),duration:600},(function(e){var n=e.radius,i=e.tube,a=e.tubularSegments,r=e.radialSegments,o=e.opacity;t.body.geometry.dispose(),t.body.geometry=new u["TorusBufferGeometry"](n,i,a,r),t.body.material.opacity=o}),(function(){t.triggerObject.remove(t.body)}))}}]),t}(),tt=$,et=n("2b0e"),nt=new et["default"];function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(n,!0).forEach((function(e){Object(c["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rt=function(){function t(e){var n=e.world,i=e.color,a=e.G;Object(o["a"])(this,t),this.world=n,this.color=i,this.G=a,this.v0=n.width/10,this.theta=90,this.stage=n.stage,this.currentProp=null,this.powerStorageDuration=1500,this.createBody(),this.particle=new J({triggerObject:this.body,world:n}),this.wave=new tt({triggerObject:this.body})}return Object(s["a"])(t,[{key:"bindEvent",value:function(){var t=this,e=this.world.container,n="ontouchstart"in document,i=n?"touchstart":"mousedown",a=n?"touchend":"mouseup",r=function(){t.poweringUp||t.jumping||(t.poweringUp=!0,t.particle.runParticleFlow(),t.powerStorage(),e.addEventListener(a,o,!1))},o=function n(i){i.preventDefault(),t.jumping||(t.jumping=!0,t.poweringUp=!1,t.particle.stopRunParticleFlow(),t.jump(),e.removeEventListener(a,n))};e.addEventListener(i,r,!1)}},{key:"createBody",value:function(){var t=this.color,e=this.world.width,n=O;n.setValues({color:t});var i=.03*e,a=new u["SphereBufferGeometry"](i,40,40),r=this.headSegment=new u["Mesh"](a,n);this.headTranslateY=6*i,r.translateY(this.headTranslateY),this.width=1.2*i*2,this.height=5*i,this.bodySize=4*i;var o=new u["CylinderBufferGeometry"](.9*i,1.2*i,2.5*i,40);o.translate(0,1.25*i,0);var s=new u["CylinderBufferGeometry"](i,.9*i,i,40);s.translate(0,3*i,0);var c=new u["SphereGeometry"](i,40,40);c.translate(0,3.5*i,0);var h=new u["Geometry"];h.merge(c),h.merge((new u["Geometry"]).fromBufferGeometry(s)),h.merge((new u["Geometry"]).fromBufferGeometry(o)),this.bodyTranslateY=1.5*i;var l=this.bodyScaleSegment=new u["Mesh"](h,n);l.castShadow=!0;var p=this.bodyRotateSegment=new u["Group"];p.add(r),p.add(l);var d=this.body=new u["Group"];d.add(p)}},{key:"enterStage",value:function(t,e,n){var i=e.x,a=e.y,r=e.z,o=this.body;o.position.set(i,a,r),this.nextProp=n,console.log(this.nextProp),t.add(o),this.bindEvent()}},{key:"resetPowerStorageParameter",value:function(){this.toValues={headTranslateY:0,bodyScaleXZ:0,bodyScaleY:0},this.fromValues=this.fromValues||{headTranslateY:this.headTranslateY,bodyScaleXZ:1,bodyScaleY:1,propScaleY:1}}},{key:"powerStorage",value:function(){var t=this,e=this.body,n=this.powerStorageDuration,i=this.headSegment,a=this.bodyScaleSegment,r=this.currentProp,o=this.world.propHeight;this.resetPowerStorageParameter(),this.powerStorageTime=Date.now();var s=R({from:at({},this.fromValues),to:{headTranslateY:this.headTranslateY-.6*this.bodySize,bodyScaleXZ:1.3,bodyScaleY:.6,propScaleY:.6},duration:n},(function(n){var c=n.headTranslateY,u=n.bodyScaleXZ,h=n.bodyScaleY,l=n.propScaleY;t.poweringUp?(i.position.setY(c),a.scale.set(u,h,u),r.body.scale.setY(l),e.position.setY(o*l),t.toValues={headTranslateY:c,bodyScaleXZ:u,bodyScaleY:h}):s.stop()}))}},{key:"computePowerStorageValue",value:function(){var t=this.powerStorageDuration,e=this.powerStorageTime,n=this.v0,i=this.theta,a=Date.now()-e,r=Math.min(a,t),o=r/t;return{v0:n+30*o,theta:i-40*o}}},{key:"jump",value:function(){var t=this,e=this.body,n=this.nextProp,i=this.currentProp,a=this.world.propHeight,r=this.width,o=400,s=e.position,c=n.getPosition(),u=s.x,l=s.y,p=s.z;if(i||u!==c.x||p!==c.z){if(!i)return;var d=this.bodyScaleSegment,f=this.headSegment,g=this.G,v=this.computePowerStorageValue(),m=v.v0,y=v.theta,w=C(m,y*(Math.PI/180),g),S=w.rangeR,P=w.rangeH,O=z(S,s,c),A=O.jumpDownX,x=O.jumpDownZ;R({from:at({x:u,z:p},this.toValues),to:at({x:A,z:x},this.fromValues),duration:o},(function(t){var n=t.x,i=t.z,a=t.headTranslateY,r=t.bodyScaleXZ,o=t.bodyScaleY;e.position.setX(n),e.position.setZ(i),f.position.setY(a),d.scale.set(r,o,r)}));var j=Math.max(this.world.width/3,P)+a,M=R({from:{y:l},to:{y:j},duration:.65*o,easing:h["a"].Easing.Cubic.Out,autoStart:!1},(function(t){var n=t.y;e.position.setY(n)})),E=R({from:{y:j},to:{y:a},duration:.35*o,easing:h["a"].Easing.Cubic.In,autoStart:!1},(function(t){var n=t.y;e.position.setY(n)}),(function(){return Y()})),k=R({from:{s:.8},to:{s:1},duration:100,autoStart:!1},(function(t){var e=t.s;d.scale.setY(e)}));M.chain(E).start(),this.flip(o),i.restoreAnimate(500);var Y=function(){var e=i.computePointInfos(r,A,x),a=n.computePointInfos(r,A,x),o=n.getPosition(),s=o.x,c=o.z,u=t.width/4;e.contains||a.contains?k.onComplete((function(){a.contains&&(t.world.createProp(),t.world.moveCamera(),nt.$emit("score",b),t.currentProp=n,t.nextProp=n.getNext()),t.particle.runParticleFountain(),Math.abs(A-s)<u&&Math.abs(x-c)<u&&t.wave.runWaveAnimate(),t.jumping=!1})).start():t.fall(e,a)}}else R({from:{y:l},to:{y:a},duration:o,easing:h["a"].Easing.Bounce.Out},(function(t){var n=t.y;e.position.setY(n)}),(function(){t.currentProp=n,t.nextProp=n.getNext(),t.jumping=!1}))}},{key:"flip",value:function(t){var e=this.currentProp,n=this.bodyRotateSegment,i=0;R({from:{deg:0},to:{deg:360},duration:t,easing:h["a"].Easing.Sinusoidal.InOut},(function(t){var a=t.deg;"x"===e.nextDirection?n.rotateZ(-(a-i)*(Math.PI/180)):n.rotateX((a-i)*(Math.PI/180)),i=a}))}},{key:"fall",value:function(t,e){this.stage;var n,i,a,r,o=this.body,s=this.currentProp,c=this.nextProp,u=this.world.propHeight,l=s.nextDirection;if(!t.isEdge||!e.isEdge){if(t.isEdge)n=t.degY,i=t.translate,a=c,r=!0;else{if(!e.isEdge)return R({from:{y:u},to:{y:0},duration:400,easing:h["a"].Easing.Bounce.Out},(function(t){var e=t.y;o.position.setY(e)}),(function(){var t="gameOver";console.log(t),nt.$emit("key",t)}));n=e.degY,i=e.translate,r="z"===l?n<90&&n>270:n<180,a=r?null:s}this.particle.destroy();var p=this.bodyRotateSegment,d=this.bodyScaleSegment,f=this.headSegment,g=this.bodyTranslateY,v=this.width,m=this.height,y=v/2;f.translateY(g),d.translateY(g),p.translateY(-g),p.rotateY(n*(Math.PI/180)),f.translateZ(i),d.translateZ(i),p.translateZ(-i);var b=0,w=0,S=0,P=a&&Y(a.body,l,r),O=R({from:{degY:0},to:{degY:90},duration:500,autoStart:!1,easing:h["a"].Easing.Quintic.In},(function(t){var e=t.degY;P&&P(o.children[0])?(O.stop(),P=null):(p.rotateX((e-w)*(Math.PI/180)),w=e)})),A=u-y-i,x=R({from:{y:0,z:0},to:{y:y-i,z:A},duration:300,autoStart:!1,easing:h["a"].Easing.Bounce.Out},(function(t){var e=t.z,n=t.y;if(P&&P(o.children[0])){x.stop();var i=Math.atan((A-e)/m);r&&"z"===l?(p.translateY(-m),o.position.z+=m,o.rotateX(-i)):"z"===l?(p.translateY(-m),o.position.z-=m,o.rotateX(i)):r&&"x"===l?(p.translateY(-m),o.position.x+=m,o.rotateZ(i)):"x"===l&&(p.translateY(-m),o.position.x-=m,o.rotateZ(-i)),P=null;var a="gameOver";console.log(a),nt.$emit("key",a)}else f.translateZ(e-b),d.translateZ(e-b),p.translateY(n-S),b=e,S=n}),(function(){var t="gameOver";console.log(t),nt.$emit("key",t)}));O.chain(x).start()}}}]),t}(),ot=rt,st=function(){function t(e){var n=e.container,i=e.canvas,a=e.needDefaultCreator,r=void 0===a||a,s=e.axesHelper,c=void 0!==s&&s;Object(o["a"])(this,t);var u=n.offsetWidth,h=n.offsetHeight;this.G=9.8,this.container=n,this.canvas=i,this.width=u,this.height=h,this.needDefaultCreator=r,this.axesHelper=c;var l=~~(u/6),p=~~(u/3.5);this.propSizeRange=[l,p],this.propHeight=~~(p/2),this.propDistanceRange=[~~(l/2),2*p],this.stage=null,this.propCreator=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){console.log(2222),this.initStage(),this.initPropCreator(),this.createProp(0),this.createProp(0),this.moveCamera(0)}},{key:"initStage",value:function(){this.container,this.canvas,this.axesHelper,this.width;var t=this.height,e=.1,n=2e3,i=this.cameraInitalPosition=P(35,225,t/2,t/2,e,n),a=this.lightInitalPosition={x:-300,y:600,z:200};this.stage=new B({container:this.container,axesHelper:!1,canvas:this.canvas,cameraInitalPosition:i,lightInitalPosition:a})}},{key:"initPropCreator",value:function(){var t=this.needDefaultCreator,e=this.propSizeRange,n=this.propHeight;this.props=[],this.propCreator=new Q({propHeight:n,propSizeRange:e,needDefaultCreator:t})}},{key:"initLittleMan",value:function(){var t=this.props,e=this.propHeight,n=this.stage,i=this.G,a=new ot({world:this,color:3696793,G:i});a.enterStage(n,{x:0,y:e+80,z:0},t[0]),a.jump()}},{key:"createPropCreator",value:function(){var t;(t=this.propCreator).createPropCreator.apply(t,arguments)}},{key:"createProp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=(this.height,this.propCreator),n=this.propHeight,i=Object(r["a"])(this.propSizeRange,2),a=i[0],o=i[1],s=this.propDistanceRange,c=this.stage,u=this.props,h=this.props.length,l=u[h-1],p=new X({world:this,stage:c,body:e.createProp(h<3?0:-1),height:n,prev:l,enterHeight:t,distanceRange:s}),d=p.getSize();d.y!==n&&console.warn("高度: ".concat(d.y,",盒子高度必须为 ").concat(n)),(d.x<a||d.x>o)&&console.warn("宽度: ".concat(d.x,", 盒子宽度必须为 ").concat(a," - ").concat(o)),(d.z<a||d.z>o)&&console.warn("深度: ".concat(d.z,", 盒子深度度必须为 ").concat(a," - ").concat(o)),l&&l.setNext(p),p.enterStage(),u.push(p)}},{key:"moveCamera",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=this.stage,i=this.height,a=this.cameraInitalPosition,r=a.x,o=a.y,s=a.z,c=this.lightInitalPosition,u=c.x,h=c.y,l=c.z,p=i/10,d=this.getLastTwoCenterPosition(),f=d.x,g=d.y,v=d.z,m={x:f+r+p,y:o,z:v+s+p},y={x:f+u,y:h,z:v+l},b={cameraTo:m,lightTo:y,center:{x:f,y:g,z:v}};n.moveCamera(b,(function(){t.clearProps()}),e)}},{key:"getLastTwoCenterPosition",value:function(){var t=this.props,e=this.props.length,n=t[e-2].getPosition(),i=n.x,a=n.z,r=t[e-1].getPosition(),o=r.x,s=r.z;return{x:i+(o-i)/2,z:a+(s-a)/2}}},{key:"clearProps",value:function(){this.width,this.height;var t=this.safeClearLength,e=this.props,n=(this.stage,this.props.length),i=4;n>t&&(e.slice(0,i).forEach((function(t){return t.dispose()})),this.props=e.slice(i))}},{key:"computeSafeClearLength",value:function(){var t=this.width,e=this.height,n=this.propSizeRange,i=n[0],a=Math.sqrt(i*i+i*i);this.safeClearLength=Math.ceil(t/i)+Math.ceil(e/a/2)+1}},{key:"restart",value:function(){var t=this.stage.scene;console.log(t),S();while(t.children.length>0)t.remove(t.children[0]);this.init()}}]),t}(),ct=st,ut={data:function(){return{game:null,isMask:!0,isRunning:!1,score:0}},mounted:function(){var t=this;this.createWorld(),nt.$on("key",(function(e){"gameOver"&&t.open()})),nt.$on("score",(function(e){t.score=e-2}))},methods:{createWorld:function(){this.game=new ct({container:document.querySelector(".jump-world"),canvas:document.querySelector("#jump-world-canvas"),axesHelper:!0})},open:function(){this.isMask=!0},restart:function(){this.isMask=!1,this.score=0,this.game.restart(),this.game.initLittleMan()},start:function(){this.isMask=!1,this.isRunning=!0,this.game.initLittleMan()}}},ht=ut,lt=(n("7988"),n("2877")),pt=Object(lt["a"])(ht,i,a,!1,null,"f2e8303a",null);e["default"]=pt.exports},"5d73":function(t,e,n){t.exports=n("469f")},"5df3":function(t,e,n){"use strict";var i=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},"673e":function(t,e,n){"use strict";n("386b")("sub",(function(t){return function(){return t(this,"sub","","")}}))},"768b":function(t,e,n){"use strict";var i=n("a745"),a=n.n(i);function r(t){if(a()(t))return t}var o=n("5d73"),s=n.n(o),c=n("c8bb"),u=n.n(c);function h(t,e){if(u()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],i=!0,a=!1,r=void 0;try{for(var o,c=s()(t);!(i=(o=c.next()).done);i=!0)if(n.push(o.value),e&&n.length===e)break}catch(h){a=!0,r=h}finally{try{i||null==c["return"]||c["return"]()}finally{if(a)throw r}}return n}}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(t,e){return r(t)||h(t,e)||l()}n.d(e,"a",(function(){return p}))},7988:function(t,e,n){"use strict";var i=n("1ba6"),a=n.n(i);a.a},"7d7b":function(t,e,n){var i=n("e4ae"),a=n("7cd6");t.exports=n("584a").getIterator=function(t){var e=a(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},8448:function(t,e,n){},"8fad":function(t,e,n){"use strict";var i=n("8448"),a=n.n(i);a.a},b0b4:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("85f2"),a=n.n(i);function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),a()(t,i.key,i)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},bac3:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REVGODRBRjIyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REVGODRBRjMyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpERUY4NEFGMDJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpERUY4NEFGMTJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgDz1z0AAAZeSURBVHja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"},cfd0:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"jump-world"},[n("canvas",{attrs:{id:"jump-world-canvas"}})])}],r=n("768b"),o=(n("ac6a"),n("d225")),s=n("b0b4"),c=(n("673e"),n("5df3"),n("1c4c"),n("5a89")),u=n("22b5"),h=Math.random,l=Math.sqrt,p=Math.floor,d=Math.pow,f=Math.sin,g=Math.cos,v=Math.tan,m=Math.PI,y=0,b=function(){return y++},w=function(){return y=0},S=[6799930,15114812,16084076,9474969,4235007,16777215];function P(t,e,n,i,a,r){var o=t*(m/180),s=e*(m/180),c=g(o)*i,u=f(o)*(r-a-n/v(o));if(!(c>u)){var h=c+(u-c)/2,l=h/v(o),p=f(s)*l,d=g(s)*l;return{x:p,y:h,z:d}}console.warn("警告: 垂直角度太小了!")}var O=new c["MeshLambertMaterial"],A=new c["BoxBufferGeometry"](1,1,1,10,4,10);A.userData.type="box";var x=new c["CylinderBufferGeometry"](1,1,1,30,5);x.userData.type="Cylinder";var j=function(t){t.geometry&&(t.geometry.dispose(),t.geometry=null),t.material&&(t.material.dispose(),t.material=null),t.parent.remove(t),t.parent=null,t=null},M=function(t){return t[p(h()*t.length)]},E=function(t,e){return p(h()*(e-t+1))+t},C=function t(e){var n=t.box3||(t.box3=new c["Box3"]);return n.setFromObject(e),n.getSize(new c["Vector3"])},z=function(t,e,n){var i=f(2*e),a=f(e),r=d(t,2)*i/n,o=d(t*a,2)/(2*n);return{rangeR:r,rangeH:o}},R=function(t,e,n){var i=t.position.clone(),a=t.geometry.attributes.position,r=a.count,o=Array.from({length:r}).map((function(t,e){return(new c["Vector3"]).fromBufferAttribute(a,e)})).filter((function(t){return"z"===e&&n?t.z<0:"z"===e?t.z>0:"x"===e&&n?t.x<0:"x"===e?t.x>0:void 0})).map((function(e){var n=e.applyMatrix4(t.matrix);return n.sub(t.position)}));return function(t){for(var e,n=0;e=o[n];n++){var a=new c["Raycaster"](i,e.clone().normalize()),r=a.intersectObject(t,!0);if(r.length>0&&r[0].distance<e.length()+1.2)return!0}return!1}},k=function(t,e,n){var i=e.x,a=e.z,r=n.x,o=n.z,s=r-i,c=o-a,u=l(d(c,2)+d(s,2)),h=s*t/u,p=c*t/u;return{jumpDownX:i+h,jumpDownZ:a+p}},Y=function(t,e,n){var i=t.from,a=t.to,r=t.duration,o=t.easing,s=void 0===o?function(t){return t}:o,c=t.autoStart,h=void 0===c||c,l=new u["a"].Tween(i).to(a,r).easing(s).onUpdate(e).onComplete((function(){n&&n()}));return h&&l.start(),D(),l},D=function t(){if(!t.openin){t.openin=!0;var e=function e(){var n=requestAnimationFrame(e);u["a"].update()||(t.openin=!1,cancelAnimationFrame(n))};e()}},I=(n("8e6e"),n("456d"),n("bd86"));function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(n,!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L=function(){function t(e){var n=e.width,i=e.height,a=e.canvas,r=e.axesHelper,s=void 0!==r&&r,c=e.cameraNear,u=e.cameraFar,h=e.cameraInitalPosition,l=e.lightInitalPosition;Object(o["a"])(this,t),this.width=n,this.height=i,this.canvas=a,this.axesHelper=s,this.cameraNear=c,this.cameraFar=u,this.cameraInitalPosition=h,this.lightInitalPosition=l,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null,this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.createScene(),this.createPlane(),this.createLight(),this.createCamera(),this.createRenterer(),this.render()}},{key:"destroy",value:function(){j(this.camera),j(this.light),j(this.plane),this.scene.remove(this.camera),this.scene.remove(this.light),this.scene.remove(this.plane),this.scene.children.forEach(j),this.scene.children=null,this.scene.dispose(),this.renderer.dispose(),this.canvas=null,this.scene=null,this.plane=null,this.light=null,this.camera=null,this.renderer=null}},{key:"reset",value:function(){var t=this.plane,e=this.light,n=this.lightTarget,i=this.lightInitalPosition,a=this.camera,r=this.cameraInitalPosition;t.position.x=0,t.position.z=0,n.position.x=0,n.position.z=0,e.position.set(i.x,i.y,i.z),a.position.x=r.x,a.position.z=r.z}},{key:"createScene",value:function(){var t=this.scene=new c["Scene"];t.background=new c["Color"](14080991),this.axesHelper&&t.add(new c["AxesHelper"](1e4))}},{key:"createPlane",value:function(){var t=this.scene,e=new c["PlaneBufferGeometry"](1e3,1e3,1,1),n=new c["ShadowMaterial"];n.opacity=.5;var i=this.plane=new c["Mesh"](e,n);i.rotation.x=-.5*Math.PI,i.position.y=-.1,i.receiveShadow=!0,t.add(i)}},{key:"createLight",value:function(){var t=this.scene,e=this.lightInitalPosition,n=e.x,i=e.y,a=e.z,r=this.height,o=this.light=new c["DirectionalLight"](16777215,.5),s=this.lightTarget=new c["Object3D"];o.target=s,o.position.set(n,i,a),o.castShadow=!0,o.shadow.camera.left=-r,o.shadow.camera.right=r,o.shadow.camera.top=r,o.shadow.camera.bottom=-r,o.shadow.camera.near=0,o.shadow.camera.far=2e3,o.shadow.mapSize.width=1600,o.shadow.mapSize.height=1600,t.add(new c["AmbientLight"](15067113,.4)),t.add(new c["HemisphereLight"](16777215,16777215,.2)),t.add(s),t.add(o)}},{key:"createCamera",value:function(){var t=this.scene,e=this.width,n=this.height,i=this.cameraInitalPosition,a=i.x,r=i.y,o=i.z,s=this.cameraNear,u=this.cameraFar,h=this.camera=new c["OrthographicCamera"](-e/2,e/2,n/2,-n/2,s,u);h.position.set(a,r,o),h.lookAt(t.position),t.add(h)}},{key:"createRenterer",value:function(){var t=this.canvas,e=this.width,n=this.height,i=this.renderer=new c["WebGLRenderer"]({canvas:t,alpha:!0,antialias:!0});i.setSize(e,n),i.shadowMap.enabled=!0,i.setPixelRatio(window.devicePixelRatio)}},{key:"render",value:function(){var t=this.scene,e=this.camera;this.renderer.render(t,e)}},{key:"moveCamera",value:function(t,e,n){var i=this,a=t.cameraTo,r=t.center,o=t.lightTo,s=this.camera,c=this.plane,u=this.light,h=this.lightTarget,l=this.lightInitalPosition;Y({from:G({},s.position),to:a,duration:n},(function(t){var e=t.x,n=t.z;s.position.x=e,s.position.z=n,i.render()}),e);var p=l.x,d=l.z;Y({from:G({},u.position),to:o,duration:n},(function(t){var e=t.x,n=t.y,i=t.z;h.position.x=e-p,h.position.z=i-d,u.position.set(e,n,i)})),c.position.x=r.x,c.position.z=r.z}},{key:"add",value:function(){var t;return(t=this.scene).add.apply(t,arguments)}},{key:"remove",value:function(){var t;return(t=this.scene).remove.apply(t,arguments)}}]),t}(),B=L,Z=[],_=[function(t,e){var n=Object(r["a"])(e.propSizeRange,2),i=n[0],a=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,c=e.baseBoxBufferGeometry;b();var u=M(S),h=y<3?a:E(i,a),l=c.clone();l.scale(h,o,h);var p=s.clone();return p.setValues({color:u}),new t.Mesh(l,p)},function(t,e){var n=Object(r["a"])(e.propSizeRange,2),i=n[0],a=n[1],o=e.propHeight,s=e.baseMeshLambertMaterial,c=e.baseCylinderBufferGeometry;b();var u=M(S),h=y<3?a:E(i,a),l=c.clone();l.scale(Math.ceil(h/2),o,Math.ceil(h/2));var p=s.clone();return p.setValues({color:u}),new t.Mesh(l,p)}],F=function(){function t(e){var n=e.propHeight,i=e.propSizeRange,a=e.needDefaultCreator;Object(o["a"])(this,t),this.propHeight=n,this.propSizeRange=i,this.propCreators=[],a&&(this.createPropCreator(_,!1),this.createPropCreator(Z,!0))}return Object(s["a"])(t,[{key:"createProp",value:function(t){var e=this.propCreators;return t>-1&&e[t]&&e[t]()||M(e)()}},{key:"createPropCreator",value:function(t,e){var n=this;if(Array.isArray(t))t.forEach((function(t){return n.createPropCreator(t,e)}));else{var i=this.propCreators,a=this.propSizeRange,r=this.propHeight;if(!(i.indexOf(t)>-1)){var o=function n(){if(e&&n.box)return n.box.clone();var i=t(c,{propSizeRange:a,propHeight:r,baseMeshLambertMaterial:O,baseBoxBufferGeometry:A,baseCylinderBufferGeometry:x});return e&&(n.box=i),i};i.push(o)}}}}]),t}(),H=F,N=n("75fc"),Q=function(){function t(e){var n=e.world,i=e.stage,a=e.body,r=e.height,s=e.enterHeight,c=e.distanceRange,u=e.prev;Object(o["a"])(this,t),this.world=n,this.stage=i,this.body=a,this.height=r,this.enterHeight=s,this.distanceRange=c,this.prev=u,this.nextDirection="",this.nextDistance=0}return Object(s["a"])(t,[{key:"computeMyPosition",value:function(){var t=this.world,e=this.prev,n=this.distanceRange,i=this.enterHeight,a={x:0,y:i,z:0};if(!e)return a;if(0===i)return a.z=t.width/2,e.nextDirection="z",a;var r=e.getPosition(),o=r.x,s=r.z,c=0===Math.round(Math.random()),u=e.getSize(),h=u.x,l=u.z,p=this.getSize(),d=p.x,f=p.z,g=E.apply(void 0,Object(N["a"])(n));return c?(a.x=o+h/2+g+d/2,a.z=s,e.nextDirection="x"):(a.x=o,a.z=s+l/2+g+f/2,e.nextDirection="z"),e.nextDistance=g,a}},{key:"enterStage",value:function(){var t=this.stage,e=this.body,n=this.height,i=this.computeMyPosition(),a=i.x,r=i.y,o=i.z;e.castShadow=!0,e.receiveShadow=!0,e.position.set(a,r,o),e.geometry.translate(0,n/2,0),t.add(e),this.entranceTransition()}},{key:"entranceTransition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:400,e=this.body,n=this.enterHeight,i=this.stage;0!==n&&Y({to:{y:0},from:{y:n},duration:t,easing:u["a"].Easing.Bounce.Out},(function(t){var n=t.y;e.position.setY(n),i.render()}))}},{key:"springbackTransition",value:function(t){var e=this.body,n=this.stage,i=e.scale.y;Y({from:{y:i},to:{y:1},duration:t,easing:u["a"].Easing.Bounce.Out},(function(t){var i=t.y;e.scale.setY(i),n.render()}))}},{key:"computePointInfos",value:function(t,e,n){var i=this.body;if(!i)return{};var a=i.geometry.userData.type,r=this.getSize(),o=r.x,s=r.z,c=this.getPosition(),u=c.x,h=c.z,l=t/2;if("box"===a){var p=o/2,d=s/2,f=u-p,g=u+p,v=h-d,m=h+d,y=e>=f&&e<=g&&n>=v&&n<=m;if(y)return{contains:y};var b=Math.abs(n-h)-d,w=Math.abs(e-u)-p;if(b>=l||w>=l)return{contains:y};var S=!1,P=0,O=0;return e<g&&e>f?(n>m&&n<m+l?P=0:n<v&&n>v-l&&(P=180),S=!0,O=b):n<m&&n>v&&(e>g&&e<g+l?P=90:e<f&&e>f-l&&(P=270),S=!0,O=w),{contains:y,translateZ:O,isEdge:S,degY:P}}var A=o/2,x=Math.sqrt(Math.pow(u-e,2)+Math.pow(h-n,2)),j=x<=A;if(j)return{contains:j};if(x>=A+l)return{contains:j};var M=!0,E=x-A,C=180*Math.atan(Math.abs(e-u)/Math.abs(n-h))/Math.PI;return e===u?C=n>h?0:180:n===h?C=e>u?90:270:e>u&&n>h||(C=e>u&&n<h?180-C:n<h?180+C:360-C),{contains:j,translateZ:E,isEdge:M,degY:C}}},{key:"setNext",value:function(t){this.next=t}},{key:"getNext",value:function(){return this.next}},{key:"getPosition",value:function(){return this.body.position}},{key:"setPosition",value:function(t,e,n){return this.body.position.set(t,e,n)}},{key:"scaleY",value:function(t){return this.body.scale.setY(t)}},{key:"getSize",value:function(){return C(this.body)}},{key:"destroy",value:function(){this.prev&&(this.prev.next=null),this.next&&(this.next.prev=null),j(this.body),this.world=null,this.stage=null,this.body=null,this.prev=null,this.next=null}}]),t}(),U=Q,V=function(){function t(e){var n=e.world,i=e.quantity,a=void 0===i?15:i,r=e.triggerObject;Object(o["a"])(this,t),this.world=n,this.quantity=a,this.triggerObject=r,this.particleSystem=null;var s=C(r),c=s.x,u=s.y;this.triggerObjectWidth=c;var h=this.flowSizeRange=[c/6,c/3];this.flowRangeY=[u/2,u-h[1]],this.initalY=h[1],this.flowRangeX=[2*-c,2*c];var l=this.fountainSizeRange=this.flowSizeRange.map((function(t){return t/2}));this.fountainRangeY=[l[1],u/3],this.fountainRangeDistance=[u/4,u/2],this.fountainRangeX=[-c/3,c/3],this.createParticle()}return Object(s["a"])(t,[{key:"destroy",value:function(){this.particleSystem&&(this.particleSystem.children.forEach(j),this.particleSystem.children=null,j(this.particleSystem)),this.world=null,this.triggerObject=null,this.particleSystem=null}},{key:"createParticle",value:function(){var t=this,e=this.quantity,i=this.triggerObject,a=new c["Color"](16777215),r=new c["Color"](5822093),o=Array.from({length:e}).map((function(t,e){return e%2?a:r})),s=this.particleSystem=new c["Group"];(new c["TextureLoader"]).load(n("e8df"),(function(e){var n=new c["Geometry"];n.vertices.push(new c["Vector3"]);var a=new c["PointsMaterial"]({size:0,map:e,transparent:!0});o.forEach((function(t){var e=n.clone(),i=a.clone();i.setValues({color:t});var r=new c["Points"](e,i);s.add(r)})),t.resetParticle(),i.add(s)}))}},{key:"resetParticle",value:function(){var t=this.particleSystem,e=this.initalY;t.children.forEach((function(t){t.position.y=e,t.position.x=0,t.position.z=0}))}},{key:"runParticleFlowPump",value:function(){var t=this.particleSystem,e=this.quantity,n=this.initalY,i=t.children.filter((function(t){return t.position.y===n}));if(!(i.length<e/3)){var a=this.triggerObjectWidth,r=this.flowRangeX,o=this.flowRangeY,s=this.flowSizeRange,c=a/2;i.forEach((function(t){var e=t.position,n=t.material,i=E.apply(void 0,Object(N["a"])(r)),a=E.apply(void 0,Object(N["a"])(r)),u=i<0?-c:c,h=a<0?-c:c;e.x=u+i,e.z=h+a,e.y=E.apply(void 0,Object(N["a"])(o)),n.setValues({size:E.apply(void 0,Object(N["a"])(s))})}))}}},{key:"runParticleFlow",value:function(){var t=this;if(!this.runingParticleFlow){this.runingParticleFlow=!0;var e=this.world,n=this.triggerObjectWidth,i=this.particleSystem,a=this.initalY,r=0,o=3*n/1e3,s=function n(){var s=requestAnimationFrame(n);if(t.runingParticleFlow){if(t.runParticleFlowPump(),r){var c=i.children.filter((function(t){return t.position.y!==a})),u=Date.now()-r,h=u*o;c.forEach((function(t){var e=t.position,n=e.x,i=e.y,r=e.z;if(i<a)e.y=a,e.x=0,e.z=0;else{var o=Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i-a,2)),s=(o-h)/o;e.x=s*n,e.z=s*r,e.y=s*i}})),e.stage.render()}r=Date.now()}else cancelAnimationFrame(s)};s()}}},{key:"stopRunParticleFlow",value:function(){this.runingParticleFlow=!1,this.resetParticle()}},{key:"runParticleFountainPump",value:function(t,e){var n=this,i=this.fountainRangeDistance,a=this.triggerObjectWidth,r=this.initalY,o=this.world;t.forEach((function(t){var e=t.position,n=e.x,r=e.y,o=e.z,s=t.userData;s.ty=r+E.apply(void 0,Object(N["a"])(i));var c=E(0,a/3);s.tx=(n<0?-c:c)+n;var u=E(0,a/3);s.tz=(o<0?-u:u)+o}));var s=0,c=Date.now(),u=3*a/600,h=function i(){var a=requestAnimationFrame(i),h=t.filter((function(t){return t.position.y!==r}));if(h.length&&!n.runingParticleFlow&&Date.now()-c<e){if(s){var l=Date.now()-s,p=l*u;h.forEach((function(t){var e=t.position,n=t.position,i=n.x,a=n.y,o=n.z,s=t.userData,c=s.tx,u=s.ty,h=s.tz;if(a>=u)e.x=0,e.y=r,e.z=0;else{var l=c-i,d=u-a,f=h-o,g=Math.sqrt(Math.pow(l,2)+Math.pow(d,2)+Math.pow(f,2)),v=p/g;e.y+=v*d,e.x+=v*l,e.z+=v*f}})),o.stage.render()}s=Date.now()}else n.runingParticleFountain=!1,cancelAnimationFrame(a)};h()}},{key:"runParticleFountain",value:function(){if(!this.runingParticleFountain){this.runingParticleFountain=!0;var t=this.particleSystem,e=this.quantity,n=this.initalY,i=t.children.filter((function(t){return t.position.y===n})).slice(0,e);if(i.length){var a=this.triggerObjectWidth,r=this.fountainRangeX,o=this.fountainSizeRange,s=this.fountainRangeY,c=a/2;i.forEach((function(t){var e=t.position,n=t.material,i=E.apply(void 0,Object(N["a"])(r)),a=E.apply(void 0,Object(N["a"])(r)),u=i<0?-c:c,h=a<0?-c:c;e.x=u+i,e.z=h+a,e.y=E.apply(void 0,Object(N["a"])(s)),n.setValues({size:E.apply(void 0,Object(N["a"])(o))})})),this.runParticleFountainPump(i,1e3)}}}}]),t}(),X=V;function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(n,!0).forEach((function(e){Object(I["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var q=function(){function t(e){var n=e.world,i=e.color,a=e.G;Object(o["a"])(this,t),this.world=n,this.color=i,this.G=a,this.v0=n.width/10,this.theta=90,this.headSegment=null,this.bodyScaleSegment=null,this.bodyRotateSegment=null,this.body=null,this.unbindFunc=null,this.currentProp=null,this.nextProp=null,this.powerStorageDuration=1500,this.stage=null,this.createBody(),this.particle=new X({triggerObject:this.body,world:n}),this.resetPowerStorageParameter()}return Object(s["a"])(t,[{key:"destroy",value:function(){this.particle.destroy(),j(this.headSegment),j(this.bodyScaleSegment),j(this.bodyRotateSegment),j(this.body),this.unbindFunc&&this.unbindFunc(),this.world=null,this.particle=null,this.headSegment=null,this.bodyScaleSegment=null,this.bodyRotateSegment=null,this.body=null,this.unbindFunc=null,this.currentProp=null,this.nextProp=null,this.stage=null}},{key:"bindEvent",value:function(){var t=this,e=this.world.canvas,n="ontouchstart"in document,i=n?"touchstart":"mousedown",a=n?"touchend":"mouseup",r=function n(){t.jumping||(t.jumping=!0,t.poweringUp=!1,t.particle.stopRunParticleFlow(),t.jump(),e.removeEventListener(a,n))},o=function(n){n.preventDefault(),t.poweringUp||t.jumping||!t.currentProp||t.gameOver||(t.poweringUp=!0,t.particle.runParticleFlow(),t.powerStorage(),e.addEventListener(a,r,!1))};return e.addEventListener(i,o,!1),function(){e.removeEventListener(i,o),e.removeEventListener(a,r)}}},{key:"createBody",value:function(){var t=this.color,e=this.world.width,n=O.clone();n.setValues({color:t});var i=this.headSize=.03*e,a=this.headTranslateY=4.5*i,r=new c["SphereGeometry"](i,16,16),o=this.headSegment=new c["Mesh"](r,n);o.castShadow=!0,o.translateY(a),this.width=1.2*i*2,this.height=5*i,this.bodySize=4*i;var s=new c["CylinderBufferGeometry"](.9*i,this.width/2,2.5*i,16);s.translate(0,1.25*i,0);var u=new c["CylinderBufferGeometry"](i,.9*i,i,16);u.translate(0,3*i,0);var h=new c["SphereGeometry"](i,16,16);h.translate(0,3.5*i,0);var l=new c["Geometry"];l.merge(h),l.merge((new c["Geometry"]).fromBufferGeometry(u)),l.merge((new c["Geometry"]).fromBufferGeometry(s));var p=this.bodyTranslateY=1.5*i,d=this.bodyScaleSegment=new c["Mesh"](l,n);d.castShadow=!0,d.translateY(-p);var f=this.bodyRotateSegment=new c["Group"];f.add(o),f.add(d),f.translateY(p);var g=this.body=new c["Group"];g.add(f)}},{key:"enterStage",value:function(t,e,n){var i=e.x,a=e.y,r=e.z,o=this.body;o.position.set(i,a,r),this.stage=t,this.nextProp=n,t.add(o),t.render(),this.unbindFunc=this.bindEvent()}},{key:"resetPowerStorageParameter",value:function(){this.toValues={headTranslateY:0,bodyScaleXZ:0,bodyScaleY:0},this.fromValues=this.fromValues||{headTranslateY:this.headTranslateY,bodyScaleXZ:1,bodyScaleY:1,propScaleY:1}}},{key:"powerStorage",value:function(){var t=this,e=this.stage,n=this.powerStorageDuration,i=this.body,a=this.bodyScaleSegment,r=this.headSegment,o=this.bodySize,s=this.fromValues,c=this.currentProp,u=this.world.propHeight;this.powerStorageTime=Date.now(),this.resetPowerStorageParameter();var h=Y({from:J({},s),to:{headTranslateY:o-.6*o,bodyScaleXZ:1.3,bodyScaleY:.6,propScaleY:.6},duration:n},(function(n){var o=n.headTranslateY,s=n.bodyScaleXZ,l=n.bodyScaleY,p=n.propScaleY;t.poweringUp?(r.position.setY(o),a.scale.set(s,l,s),c.scaleY(p),i.position.setY(u*p),t.toValues={headTranslateY:o,bodyScaleXZ:s,bodyScaleY:l},e.render()):h.stop()}))}},{key:"computePowerStorageValue",value:function(){var t=this.powerStorageDuration,e=this.powerStorageTime,n=this.v0,i=this.theta,a=Date.now()-e,r=Math.min(a,t),o=r/t;return{v0:n+30*o,theta:i-40*o}}},{key:"jump",value:function(){var t=this,e=this.stage,n=this.body,i=this.currentProp,a=this.nextProp,r=this.world.propHeight,o=400,s=n.position,c=a.getPosition(),h=s.x,l=s.y,p=s.z;if(i||h!==c.x||p!==c.z){if(!i)return;var d=this.bodyScaleSegment,f=this.headSegment,g=this.G,v=this.world,m=this.width,y=this.computePowerStorageValue(),b=y.v0,w=y.theta,S=z(b,w*(Math.PI/180),g),P=S.rangeR,O=S.rangeH,A=k(P,s,c),x=A.jumpDownX,j=A.jumpDownZ;Y({from:J({x:h,z:p},this.toValues),to:J({x:x,z:j},this.fromValues),duration:o},(function(t){var e=t.x,i=t.z,a=t.headTranslateY,r=t.bodyScaleXZ,o=t.bodyScaleY;n.position.setX(e),n.position.setZ(i),f.position.setY(a),d.scale.set(r,o,r)}));var M=Math.max(v.width/3,O)+r,E=Y({from:{y:l},to:{y:M},duration:.65*o,easing:u["a"].Easing.Cubic.Out,autoStart:!1},(function(t){var e=t.y;n.position.setY(e)})),C=Y({from:{y:M},to:{y:r},duration:.35*o,easing:u["a"].Easing.Cubic.In,autoStart:!1},(function(t){var e=t.y;n.position.setY(e)}),(function(){return R()}));E.chain(C).start(),this.flip(o),i.springbackTransition(500);var R=function(){var e=i.computePointInfos(m,x,j),n=a.computePointInfos(m,x,j);e.contains||n.contains?D.onComplete((function(){n.contains&&(v.createProp(),v.moveCamera(),t.currentProp=a,t.nextProp=a.getNext()),t.particle.runParticleFountain(),t.jumping=!1})).start():(console.log("GameOver"),t.fall(e,n))},D=Y({from:{s:.8},to:{s:1},duration:100,autoStart:!1},(function(t){var e=t.s;d.scale.setY(e)}))}else Y({from:{y:l},to:{y:r},duration:o,easing:u["a"].Easing.Bounce.Out},(function(t){var i=t.y;n.position.setY(i),e.render()}),(function(){t.currentProp=a,t.nextProp=a.getNext(),t.jumping=!1}))}},{key:"flip",value:function(t){var e=this.currentProp,n=this.bodyRotateSegment,i=0;Y({from:{deg:0},to:{deg:360},duration:t,easing:u["a"].Easing.Sinusoidal.InOut},(function(t){var a=t.deg;"x"===e.nextDirection?n.rotateZ(-(a-i)*(Math.PI/180)):n.rotateX((a-i)*(Math.PI/180)),i=a}))}},{key:"fall",value:function(t,e){var n,i,a,r,o=this.stage,s=this.body,c=this.currentProp,h=this.nextProp,l=this.world.propHeight,p=c.nextDirection;if(!t.isEdge||!e.isEdge){if(t.isEdge)n=t.degY,i=t.translateZ,a=h,r=!0;else{if(!e.isEdge)return Y({from:{y:l},to:{y:0},duration:400,easing:u["a"].Easing.Bounce.Out},(function(t){var e=t.y;s.position.setY(e),o.render()}));n=e.degY,i=e.translateZ,r="z"===p?n<90&&n>270:n<180,a=r?null:c}this.particle.destroy();var d=this.bodyRotateSegment,f=this.bodyScaleSegment,g=this.headSegment,v=this.bodyTranslateY,m=this.width,y=this.height,b=m/2;g.translateY(v),f.translateY(v),d.translateY(-v),d.rotateY(n*(Math.PI/180)),g.translateZ(i),f.translateZ(i),d.translateZ(-i);var w=0,S=0,P=0,O=a&&R(a.body,p,r),A=Y({from:{degY:0},to:{degY:90},duration:500,autoStart:!1,easing:u["a"].Easing.Quintic.In},(function(t){var e=t.degY;O&&O(s.children[0])?(A.stop(),O=null):(d.rotateX((e-S)*(Math.PI/180)),S=e,o.render())})),x=l-b-i,j=Y({from:{y:0,z:0},to:{y:b-i,z:x},duration:300,autoStart:!1,easing:u["a"].Easing.Bounce.Out},(function(t){var e=t.z,n=t.y;if(O&&O(s.children[0])){j.stop();var i=Math.atan((x-e)/y);r&&"z"===p?(d.translateY(-y),s.position.z+=y,s.rotateX(-i)):"z"===p?(d.translateY(-y),s.position.z-=y,s.rotateX(i)):r&&"x"===p?(d.translateY(-y),s.position.x+=y,s.rotateZ(i)):"x"===p&&(d.translateY(-y),s.position.x-=y,s.rotateZ(-i)),o.render(),O=null}else g.translateZ(e-w),f.translateZ(e-w),d.translateY(n-P),w=e,P=n,o.render()}));A.chain(j).start()}}}]),t}(),K=q,$=function(){function t(e){var n=e.container,i=e.canvas,a=e.needDefaultCreator,r=void 0===a||a,s=e.axesHelper,c=void 0!==s&&s;Object(o["a"])(this,t);var u=n.offsetWidth,h=n.offsetHeight;this.G=9.8,this.container=n,this.canvas=i,this.width=u,this.height=h,this.needDefaultCreator=r,this.axesHelper=c;var l=~~(u/6),p=~~(u/3.5);this.propSizeRange=[l,p],this.propHeight=~~(p/2),this.propDistanceRange=[~~(l/2),2*p],this.stage=null,this.propCreator=null,this.littleMans=[],this.props=[],this.init()}return Object(s["a"])(t,[{key:"init",value:function(){this.initStage(),this.initPropCreator(),this.computeSafeClearLength(),this.createProp(0),this.createProp(0),this.moveCamera(0),this.initLittleMan()}},{key:"destroy",value:function(){this.clear()}},{key:"clear",value:function(){this.stage&&this.stage.reset(),this.props.forEach((function(t){return t.destroy()})),this.props=[],w(),this.littleMans.forEach((function(t){return t.destroy()})),this.littleMans=[]}},{key:"initStage",value:function(){var t=this.canvas,e=this.axesHelper,n=this.width,i=this.height,a=.1,r=2e3,o=this.cameraInitalPosition=P(35,225,i/2,i/2,a,r),s=this.lightInitalPosition={x:-300,y:600,z:200};this.stage=new B({width:n,height:i,canvas:t,axesHelper:e,cameraNear:a,cameraFar:r,cameraInitalPosition:o,lightInitalPosition:s})}},{key:"initPropCreator",value:function(){var t=this.needDefaultCreator,e=this.propSizeRange,n=this.propHeight;this.propCreator=new H({propHeight:n,propSizeRange:e,needDefaultCreator:t})}},{key:"createPropCreator",value:function(){var t;(t=this.propCreator).createPropCreator.apply(t,arguments)}},{key:"initLittleMan",value:function(){var t=this.stage,e=this.propHeight,n=this.G,i=this.props,a=new K({world:this,color:3696793,G:n});a.enterStage(t,{x:0,y:e+80,z:0},i[0]),a.jump(),this.littleMans.push(a)}},{key:"createProp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.propCreator,i=this.propHeight,a=Object(r["a"])(this.propSizeRange,2),o=a[0],s=a[1],c=this.propDistanceRange,u=this.stage,h=this.props,l=this.props.length,p=h[l-1],d=new U({world:this,stage:u,body:n.createProp(-1===e&&l<3?0:e),height:i,prev:p,enterHeight:t,distanceRange:c}),f=d.getSize();return f.y!==i&&console.warn("高度: ".concat(f.y,",盒子高度必须为 ").concat(i)),(f.x<o||f.x>s)&&console.warn("宽度: ".concat(f.x,", 盒子宽度必须为 ").concat(o," - ").concat(s)),(f.z<o||f.z>s)&&console.warn("深度: ".concat(f.z,", 盒子深度度必须为 ").concat(o," - ").concat(s)),p&&p.setNext(d),d.enterStage(),h.push(d),d}},{key:"moveCamera",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=this.stage,i=this.height,a=this.cameraInitalPosition,r=a.x,o=a.y,s=a.z,c=this.lightInitalPosition,u=c.x,h=c.y,l=c.z,p=i/10,d=this.getLastTwoCenterPosition(),f=d.x,g=d.y,v=d.z,m={x:f+r+p,y:o,z:v+s+p},y={x:f+u,y:h,z:v+l},b={cameraTo:m,lightTo:y,center:{x:f,y:g,z:v}};n.moveCamera(b,(function(){t.clearProps()}),e)}},{key:"getLastTwoCenterPosition",value:function(){var t=this.props,e=this.props.length,n=t[e-2].getPosition(),i=n.x,a=n.z,r=t[e-1].getPosition(),o=r.x,s=r.z;return{x:i+(o-i)/2,z:a+(s-a)/2}}},{key:"clearProps",value:function(){var t=this.safeClearLength,e=this.props,n=this.props.length,i=4;n>t&&(e.slice(0,i).forEach((function(t){return t.destroy()})),this.props=e.slice(i))}},{key:"computeSafeClearLength",value:function(){var t=this.width,e=this.height,n=this.propSizeRange,i=n[0],a=Math.sqrt(i*i+i*i);this.safeClearLength=Math.ceil(t/i)+Math.ceil(e/a/2)+1}}]),t}(),tt=$,et={mounted:function(){new tt({container:document.querySelector(".jump-world"),canvas:document.querySelector("#jump-world-canvas"),axesHelper:!0})}},nt=et,it=(n("8fad"),n("2877")),at=Object(it["a"])(nt,i,a,!1,null,"9a0b2f7a",null);e["default"]=at.exports},d225:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return i}))},e8df:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6REVGODRBRjIyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6REVGODRBRjMyRjU2MTFFNUExM0Y4OUExMTc4QTBCQUMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpERUY4NEFGMDJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpERUY4NEFGMTJGNTYxMUU1QTEzRjg5QTExNzhBMEJBQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgDz1z0AAAZeSURBVHja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"},f28c:function(t,e){var n,i,a=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}function c(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(function(){try{n="function"===typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"===typeof clearTimeout?clearTimeout:o}catch(t){i=o}})();var u,h=[],l=!1,p=-1;function d(){l&&u&&(l=!1,u.length?h=u.concat(h):p=-1,h.length&&f())}function f(){if(!l){var t=s(d);l=!0;var e=h.length;while(e){u=h,h=[];while(++p<e)u&&u[p].run();p=-1,e=h.length}u=null,l=!1,c(t)}}function g(t,e){this.fun=t,this.array=e}function v(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new g(t,e)),1!==h.length||l||s(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=v,a.addListener=v,a.once=v,a.off=v,a.removeListener=v,a.removeAllListeners=v,a.emit=v,a.prependListener=v,a.prependOnceListener=v,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}}}]);